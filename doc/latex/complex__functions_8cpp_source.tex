\doxysection{complex\+\_\+functions.\+cpp}
\hypertarget{complex__functions_8cpp_source}{}\label{complex__functions_8cpp_source}\index{/Users/kuba/Desktop/R-\/Matrix/AZURE2/coul/src/complex\_functions.cpp@{/Users/kuba/Desktop/R-\/Matrix/AZURE2/coul/src/complex\_functions.cpp}}
\mbox{\hyperlink{complex__functions_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{complex__functions_8_h}{complex\_functions.H}}"{}}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00003}00003\ \textcolor{comment}{//\ Precise\ evaluation\ of\ exp[z]-\/1\ for\ z\ complex}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00004}00004\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00005}00005\ \textcolor{comment}{//\ When\ |Re[z]|\ >=\ 1\ or\ |Im[z]|\ >=\ 1,\ one\ uses\ directly\ the\ standard\ exp\ function\ as\ it\ is\ precise.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00006}00006\ \textcolor{comment}{//\ Otherwise,\ numerical\ cancellations\ can\ occur.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00007}00007\ \textcolor{comment}{//\ So,\ one\ uses\ the\ always\ stable\ formula\ exp[z]-\/1\ =\ expm1(x)\ -\/\ 2.exp(x).sin\string^2(y/2)\ +\ i.exp(x).sin(y)\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00008}00008\ \textcolor{comment}{//\ with\ x\ =\ Re[z]\ and\ y\ =\ Im[z].\ expm1(x)\ gives\ a\ precise\ evaluation\ of\ exp(x)-\/1\ for\ x\ double.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00010}\mbox{\hyperlink{complex__functions_8_h_ade2fecd7fc202b30a4d210e46a27aa80}{00010}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_ade2fecd7fc202b30a4d210e46a27aa80}{expm1}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00011}00011\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00012}00012\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00014}00014\ \ \ \textcolor{keywordflow}{if}\ ((std::abs\ (x)\ >=\ 1.0)\ ||\ (std::abs\ (y)\ >=\ 1.0))\ \textcolor{keywordflow}{return}\ (exp\ (z)\ -\/\ 1.0);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00016}00016\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ expm1\_x\ =\ \mbox{\hyperlink{complex__functions_8cpp_ade2fecd7fc202b30a4d210e46a27aa80}{expm1}}\ (x),exp\_x\ =\ 1.0\ +\ expm1\_x,sin\_y\_over\_two\ =\ sin\ (0.5*y),sin\_y\ =\ sin\ (y);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00018}00018\ \ \ \textcolor{keywordflow}{return}\ std::complex<double>\ (expm1\_x\ -\/\ 2.0*exp\_x*sin\_y\_over\_two*sin\_y\_over\_two,exp\_x*sin\_y);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00019}00019\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00023}00023\ \textcolor{comment}{//\ Precise\ evaluation\ of\ log[1+z]\ for\ z\ complex}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00024}00024\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00025}00025\ \textcolor{comment}{//\ When\ |Re[z]|\ >=\ 1\ or\ |Im[z]|\ >=\ 1,\ one\ uses\ directly\ the\ standard\ log\ function\ as\ it\ is\ precise.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00026}00026\ \textcolor{comment}{//\ Otherwise,\ numerical\ cancellations\ can\ occur.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00027}00027\ \textcolor{comment}{//\ So,\ one\ uses\ the\ always\ stable\ formula\ log[1+z]\ =\ log1p(x)\ +\ log1p([y/(1+x)]\string^2)/2\ +\ i.atan2(y,1+x)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00028}00028\ \textcolor{comment}{//\ with\ x\ =\ Re[z]\ and\ y\ =\ Im[z].\ log1p(x)\ gives\ a\ precise\ evaluation\ of\ log(1+x)\ for\ x\ double.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00029}00029\ \textcolor{comment}{//\ atan2(x,y)\ gives\ the\ arc\ tangent\ of\ y/x\ so\ it\ is\ in\ ]-\/Pi:Pi].\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00031}\mbox{\hyperlink{complex__functions_8_h_a046207d48c55e2d6202da49b06039c49}{00031}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a046207d48c55e2d6202da49b06039c49}{log1p}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00032}00032\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00033}00033\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z);\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00035}00035\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ xp1\ =\ 1.0\ +\ x,abs\_x\ =\ std::abs\ (x),\ abs\_y\ =\ std::abs\ (y);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00037}00037\ \ \ \textcolor{keywordflow}{if}\ ((abs\_x\ >=\ 1.0)\ ||\ (abs\_y\ >=\ 1.0))\ \textcolor{keywordflow}{return}\ log\ (1.0\ +\ z);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00038}00038\ \ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00039}00039\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ y\_over\_xp1\ =\ y/xp1;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00041}00041\ \ \ \textcolor{keywordflow}{return}\ std::complex<double>\ (\mbox{\hyperlink{complex__functions_8cpp_a046207d48c55e2d6202da49b06039c49}{log1p}}\ (x)\ +\ 0.5*\mbox{\hyperlink{complex__functions_8cpp_a046207d48c55e2d6202da49b06039c49}{log1p}}\ (y\_over\_xp1*y\_over\_xp1),atan2\ (y,xp1));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00042}00042\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00044}00044\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00047}00047\ \textcolor{comment}{//\ Logarithm\ of\ Gamma[z],\ z\ anywhere\ in\ the\ complex\ plane\ except\ in\ the\ Gamma\ function\ poles.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00048}00048\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00049}00049\ \textcolor{comment}{//\ If\ z\ is\ not\ finite\ or\ is\ a\ negative\ integer,\ the\ program\ returns\ an\ error\ message\ and\ stops.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00050}00050\ \textcolor{comment}{//\ The\ Lanczos\ method\ is\ used.\ Precision\ :\ <\ 2E-\/10\ in\ theory,\ <\ 1E-\/12\ in\ almost\ every\ case.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00051}00051\ \textcolor{comment}{//\ The\ method\ works\ for\ Re[z]\ >\ 0.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00052}00052\ \textcolor{comment}{//\ If\ Re[z]\ <=\ 0,\ one\ uses\ the\ formula\ Gamma[z].Gamma[1-\/z]\ =\ Pi/sin\ (Pi.z).}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00053}00053\ \textcolor{comment}{//\ log[sin(Pi.z)]\ is\ calculated\ with\ the\ Kolbig\ method\ (K.S.\ Kolbig,\ Comp.\ Phys.\ Comm.,\ Vol.\ 4,\ p.221\ (1972))\ :\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00054}00054\ \textcolor{comment}{//\ If\ z\ =\ x+iy\ and\ y\ >=\ 0,\ log[sin(Pi.z)]\ =\ log[sin(Pi.eps)]\ -\/\ i.Pi.n,\ with\ z\ =\ n\ +\ eps\ so\ 0\ <=\ Re[eps]\ <\ 1\ and\ n\ integer.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00055}00055\ \textcolor{comment}{//\ If\ y\ >\ 110,\ log[sin(Pi.z)]\ =\ -\/i.Pi.z\ +\ log[0.5]\ +\ i.Pi/2\ numerically\ so\ that\ no\ overflow\ can\ occur.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00056}00056\ \textcolor{comment}{//\ If\ z\ =\ x+iy\ and\ y\ <\ 0,\ log[Gamma(z)]\ =\ [log[Gamma(z*)]]*,\ so\ that\ one\ can\ use\ the\ previous\ formula\ with\ z*.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00057}00057\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00058}00058\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00059}00059\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00060}00060\ \textcolor{comment}{//\ z,z\_p\_0p5,z\_p\_5p5\ :\ argument\ of\ the\ Gamma\ function,\ z+0.5,\ z+5.5\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00061}00061\ \textcolor{comment}{//\ sqrt\_2Pi,log\_Pi\ :\ sqrt(2.Pi),\ log(Pi).}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00062}00062\ \textcolor{comment}{//\ sum\ :\ Rational\ function\ in\ the\ Lanczos\ method.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00063}00063\ \textcolor{comment}{//\ log\_Gamma\_z\ :\ log[Gamma(z)]\ value.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00064}00064\ \textcolor{comment}{//\ c\ :\ table\ containing\ the\ seven\ coefficients\ in\ the\ expansion\ used\ in\ the\ Lanczos\ method.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00065}00065\ \textcolor{comment}{//\ eps\ :\ z\ =\ n\ +\ eps\ so\ 0\ <=\ Re[eps]\ <\ 1\ and\ n\ integer.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00066}00066\ \textcolor{comment}{//\ log\_const\ :\ log[0.5]\ +\ i.Pi/2}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00068}\mbox{\hyperlink{complex__functions_8_h_a0873d8d329cfe86a118711b1f96c5d8a}{00068}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00069}00069\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00070}00070\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (z))\ std::cout<<\textcolor{stringliteral}{"{}z\ is\ not\ finite\ in\ log\_Gamma."{}}<<std::endl,\ abort\ ();}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00072}00072\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00074}00074\ \ \ \textcolor{keywordflow}{if}\ ((z\ ==\ rint\ (x))\ \&\&\ (x\ <=\ 0))\ std::cout<<\textcolor{stringliteral}{"{}z\ is\ negative\ integer\ in\ log\_Gamma."{}}<<std::endl,\ abort\ ();}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00076}00076\ \ \ \textcolor{keywordflow}{if}\ (x\ >\ 0.0)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00077}00077\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00078}00078\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_p\_0p5\ =\ z\ +\ 0.5,\ z\_p\_5p5\ =\ z\ +\ 5.5;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00079}00079\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ sqrt\_2Pi\ =\ 2.5066282746310005;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00080}00080\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ c[7]\ =\ \{1.000000000190015,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ 7.618009172947146E+1,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ -\/8.650532032941677E+1,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ 2.401409824083091E+1,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ -\/1.231739572450155,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.1208650973866179E-\/2,}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.5395239384953000E-\/5\};}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00087}00087\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00088}00088\ \ \ \ \ std::complex<double>\ sum\ =\ c[0];}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00089}00089\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1\ ;\ i\ <\ 7\ ;\ i++)\ sum\ +=\ c[i]/(z\ +\ i);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00090}00090\ \ \ \ \ sum\ *=\ sqrt\_2Pi;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00092}00092\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_Gamma\_z\ =\ log\ (sum)\ -\/\ log\ (z)\ +\ z\_p\_0p5*log\ (z\_p\_5p5)\ -\/\ z\_p\_5p5;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_Gamma\_z;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00095}00095\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00096}00096\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\ >=\ 0.0)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00097}00097\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00098}00098\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ n\ =\ (x\ <\ rint\ (x))\ ?\ (static\_cast<int>\ (rint\ (x))\ -\/\ 1)\ :\ (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}\ (rint\ (x)));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00099}00099\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ log\_Pi\ =\ 1.1447298858494002;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00100}00100\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_const(-\/M\_LN2,M\_PI\_2),i\_Pi(0.0,M\_PI);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00101}00101\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ eps\ =\ z\ -\/\ n,log\_sin\_Pi\_z\ =\ (y\ >\ 110)\ ?\ (-\/i\_Pi*z\ +\ log\_const)\ :\ (log\ (sin\ (M\_PI*eps))\ -\/\ i\_Pi*n);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00102}00102\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_Gamma\_z\ =\ log\_Pi\ -\/\ log\_sin\_Pi\_z\ -\/\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (1.0\ -\/\ z);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00103}00103\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00104}00104\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_Gamma\_z;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00105}00105\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00106}00106\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00107}00107\ \ \ \ \ \textcolor{keywordflow}{return}\ conj\ (\mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (conj\ (z)));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00108}00108\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00111}00111\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00112}00112\ \textcolor{comment}{//\ Coulomb\ phase\ shift.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00113}00113\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00114}00114\ \textcolor{comment}{//\ It\ is\ given\ by\ the\ formula\ [Gamma[1+l+I.eta]\ -\/\ Gamma[1+l-\/I.eta]]/[2i].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00115}00115\ \textcolor{comment}{//\ 0\ is\ returned\ if\ 1+l+/-\/I.eta\ is\ a\ negative\ integer.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00116}00116\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00117}00117\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00118}00118\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00119}00119\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00120}00120\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00121}00121\ \textcolor{comment}{//\ Ieta,one\_over\_two\_I\ :\ i.eta,1/[2.i]\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00122}00122\ \textcolor{comment}{//\ arg\_plus,arg\_minus\ :\ 1+l+i.eta,\ 1+l-\/i.eta.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00123}00123\ \textcolor{comment}{//\ log\_Gamma\_plus,log\_Gamma\_minus\ :\ logs\ of\ Gamma[1+l+I.eta],\ Gamma[1+l-\/I.eta].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00124}00124\ \textcolor{comment}{//\ sigma\_l\ :\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00126}\mbox{\hyperlink{complex__functions_8_h_aed60e5bab259589d13c0b2922aed0521}{00126}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_aed60e5bab259589d13c0b2922aed0521}{sigma\_l\_calc}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00127}00127\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00128}00128\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (eta),real\ (eta)),one\_over\_two\_I(0,-\/0.5);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00129}00129\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ arg\_plus\ =\ 1.0\ +\ l\ +\ Ieta,\ arg\_minus\ =\ 1.0\ +\ l\ -\/\ Ieta;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00131}00131\ \ \ \textcolor{keywordflow}{if}\ ((rint\ (real\ (arg\_plus))\ ==\ arg\_plus)\ \&\&\ (rint\ (real\ (arg\_plus))\ <=\ 0.0))\ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00132}00132\ \ \ \textcolor{keywordflow}{if}\ ((rint\ (real\ (arg\_minus))\ ==\ arg\_minus)\ \&\&\ (rint\ (real\ (arg\_minus))\ <=\ 0.0))\ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00133}00133\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00134}00134\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_Gamma\_plus\ =\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (arg\_plus),log\_Gamma\_minus\ =\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (arg\_minus);\ \ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00135}00135\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sigma\_l\ =\ (log\_Gamma\_plus\ -\/\ log\_Gamma\_minus)*one\_over\_two\_I;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00136}00136\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00137}00137\ \ \ \textcolor{keywordflow}{return}\ sigma\_l;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00138}00138\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00141}00141\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00143}00143\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00145}00145\ \textcolor{comment}{//\ log\ of\ C(l,eta)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00146}00146\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00147}00147\ \textcolor{comment}{//\ It\ is\ given\ by\ the\ formula\ l*log[2]\ -\/\ eta.Pi/2\ +\ (log[Gamma[1+l+I.eta]]\ +\ log[Gamma[1+l-\/I.eta]])/2.0\ -\/\ log[Gamma[2l+2]].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00148}00148\ \textcolor{comment}{//\ 0\ is\ returned\ if\ 1+l+/-\/I.eta\ is\ a\ negative\ integer.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00149}00149\ \textcolor{comment}{//\ 2l+2\ should\ not\ be\ a\ negative\ integer\ :\ one\ has\ to\ use\ -\/l-\/1\ instead\ of\ l\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00150}00150\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00151}00151\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00152}00152\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00153}00153\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00154}00154\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00155}00155\ \textcolor{comment}{//\ Ieta\ :\ i.eta\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00156}00156\ \textcolor{comment}{//\ arg\_plus,arg\_minus\ :\ 1+l+i.eta,\ 1+l-\/i.eta.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00157}00157\ \textcolor{comment}{//\ log\_Gamma\_plus,log\_Gamma\_minus,log\_Gamma\_2l\_plus\_2\ :\ logs\ of\ Gamma[1+l+I.eta],\ Gamma[1+l-\/I.eta],\ Gamma[2l+2].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00158}00158\ \textcolor{comment}{//\ log\_Cl\_eta\ :\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00160}\mbox{\hyperlink{complex__functions_8_h_a049970d07da79ce7e09947878f7db115}{00160}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a049970d07da79ce7e09947878f7db115}{log\_Cl\_eta\_calc}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00161}00161\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00162}00162\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (eta),real\ (eta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00163}00163\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ arg\_plus\ =\ 1.0\ +\ l\ +\ Ieta,\ arg\_minus\ =\ 1.0\ +\ l\ -\/\ Ieta;\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00165}00165\ \ \ \textcolor{keywordflow}{if}\ ((rint\ (real\ (arg\_plus))\ ==\ arg\_plus)\ \&\&\ (rint\ (real\ (arg\_plus))\ <=\ 0.0))\ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00166}00166\ \ \ \textcolor{keywordflow}{if}\ ((rint\ (real\ (arg\_minus))\ ==\ arg\_minus)\ \&\&\ (rint\ (real\ (arg\_minus))\ <=\ 0.0))\ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00168}00168\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_Gamma\_plus\ =\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (arg\_plus),log\_Gamma\_minus\ =\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (arg\_minus),log\_Gamma\_2l\_plus\_2\ =\ \mbox{\hyperlink{complex__functions_8cpp_a0873d8d329cfe86a118711b1f96c5d8a}{log\_Gamma}}\ (2.0*l\ +\ 2.0);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00169}00169\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_Cl\_eta\ =\ l*M\_LN2\ -\/\ M\_PI\_2*eta\ +\ 0.5*(log\_Gamma\_plus\ +\ log\_Gamma\_minus)\ -\/\ log\_Gamma\_2l\_plus\_2;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00170}00170\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00171}00171\ \ \ \textcolor{keywordflow}{return}\ log\_Cl\_eta;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00172}00172\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00176}00176\ \textcolor{comment}{//\ Cut\ constant\ log\ for\ the\ asymptotic\ series.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00177}00177\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00178}00178\ \textcolor{comment}{//\ The\ asymptotic\ series\ and\ H[omega]\ behave\ differently\ near\ the\ negative\ real\ axis.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00179}00179\ \textcolor{comment}{//\ Then,\ if\ one\ is\ in\ the\ bad\ quadrant\ of\ H[omega],\ one\ has\ to\ take\ into\ account\ the\ cut\ directly.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00180}00180\ \textcolor{comment}{//\ One\ is\ in\ the\ bad\ quadrant\ of\ H[omega]\ if\ Re[z]\ <\ 0.0\ and\ sign(Im[z])\ =\ -\/omega.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00181}00181\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00182}00182\ \textcolor{comment}{//\ H[omega]\ =\ [H[omega]\ from\ asymptotic\ function\ formula]\ +\ (1\ -\/\ exp(2.i.Pi.(i.eta\ -\/\ l.omega))).[H[-\/omega]\ from\ asymptotic\ function\ formula]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00183}00183\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00184}00184\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00185}00185\ \textcolor{comment}{//\ The\ cut\ constant\ log\ is\ then\ log\ [1\ -\/\ exp(2.i.Pi.(i.eta\ -\/\ l.omega))].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00186}00186\ \textcolor{comment}{//\ Its\ returned\ imaginary\ part\ is\ not\ necessarily\ in\ ]-\/Pi:Pi]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00187}00187\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00188}00188\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00189}00189\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00190}00190\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00191}00191\ \textcolor{comment}{//\ omega\ :\ 1\ or\ -\/1.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00192}00192\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00193}00193\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00194}00194\ \textcolor{comment}{//\ Ieta\ :\ i.eta}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00195}00195\ \textcolor{comment}{//\ l\_int,Ieta\_int\ :\ closest\ integers\ to\ Re[l],Re[i.eta]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00196}00196\ \textcolor{comment}{//\ eps\ :\ \ (Ieta\ -\/\ Ieta\_int)\ -\/\ (l.omega\ -\/\ l\_int.omega)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00197}00197\ \textcolor{comment}{//\ two\_I\_Pi,\ two\_I\_Pi\_eps\ :\ 2.i.Pi,\ 2.i.Pi.eps\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00198}00198\ \textcolor{comment}{//\ log\_cut\_constant\ :\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00200}\mbox{\hyperlink{complex__functions_8_h_abf404794b561b7f604049b5c51954ca4}{00200}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_abf404794b561b7f604049b5c51954ca4}{log\_cut\_constant\_AS\_calc}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00201}00201\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00202}00202\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (eta),real\ (eta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00203}00203\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ l\_int\ =\ rint\ (real\ (l)),\ Ieta\_int\ =\ rint\ (real\ (Ieta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00204}00204\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ eps\ =\ (Ieta\ -\/\ Ieta\_int)\ -\/\ omega*(l\ -\/\ l\_int);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00205}00205\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00206}00206\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ two\_I\_Pi(0,2.0*M\_PI),two\_I\_Pi\_eps\ =\ two\_I\_Pi*eps;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00207}00207\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00208}00208\ \ \ \textcolor{keywordflow}{if}\ (real\ (two\_I\_Pi\_eps)\ >\ -\/0.1)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00209}00209\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00210}00210\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\ =\ log\ (\mbox{\hyperlink{complex__functions_8cpp_ade2fecd7fc202b30a4d210e46a27aa80}{expm1}}\ (-\/two\_I\_Pi\_eps))\ +\ two\_I\_Pi\_eps;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00211}00211\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00212}00212\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_cut\_constant;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00213}00213\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00214}00214\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00215}00215\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00216}00216\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\ =\ \mbox{\hyperlink{complex__functions_8cpp_a046207d48c55e2d6202da49b06039c49}{log1p}}\ (-\/exp\ (two\_I\_Pi\_eps));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00217}00217\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00218}00218\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_cut\_constant;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00219}00219\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00220}00220\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00223}00223\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00226}00226\ \textcolor{comment}{//\ Cut\ constant\ log\ for\ continued\ fractions\ :\ H[omega]\ from\ H[omega,\ not\ corrected]\ case.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00227}00227\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00228}00228\ \textcolor{comment}{//\ The\ continued\ fraction\ has\ no\ cut\ on\ the\ negative\ real\ axis,\ whereas\ H[omega]\ has\ one.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00229}00229\ \textcolor{comment}{//\ Then,\ if\ one\ is\ in\ the\ bad\ quadrant\ of\ H[omega],\ one\ has\ to\ take\ into\ account\ the\ cut\ directly.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00230}00230\ \textcolor{comment}{//\ One\ is\ in\ the\ bad\ quadrant\ of\ H[omega]\ if\ Re[z]\ <\ 0.0\ and\ sign(Im[z])\ =\ -\/omega.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00231}00231\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00232}00232\ \textcolor{comment}{//\ H[omega]\ =\ H[omega,\ not\ corrected]\ -\/\ cut\_constant.F\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00233}00233\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00234}00234\ \textcolor{comment}{//\ The\ cut\ constant\ is\ 2i.omega.norm.(exp\ (2.i.Pi.[l.omega\ -\/\ i.eta])\ -\/\ 1),\ and\ one\ takes\ its\ log.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00235}00235\ \textcolor{comment}{//\ The\ imaginary\ part\ of\ the\ log\ is\ not\ necessarily\ in\ ]-\/Pi:Pi].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00236}00236\ \textcolor{comment}{//\ Norm\ is\ 1.0\ for\ normalized\ wave\ functions,\ C(l,eta)\string^2\ for\ unnormalized\ wave\ functions.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00237}00237\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00238}00238\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00239}00239\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00240}00240\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ \ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00241}00241\ \textcolor{comment}{//\ is\_it\_normalized\ :\ true\ if\ one\ wants\ normalized\ functions,\ i.e.\ the\ standard\ normalization,}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00242}00242\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ false\ if\ one\ wants\ F\ -\/>\ F/C(l,eta)\ and\ H+/H-\//G\ -\/>\ H+/H-\//G.C(l,eta),\ to\ avoid\ overflows\ for\ |eta|\ >>\ 1\ and\ |z|\ small.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00243}00243\ \textcolor{comment}{//\ omega\ :\ 1\ or\ -\/1.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00244}00244\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00245}00245\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00246}00246\ \textcolor{comment}{//\ Ieta\ :\ i.eta\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00247}00247\ \textcolor{comment}{//\ l\_int,Ieta\_int\ :\ closest\ integers\ to\ Re[l],Re[i.eta]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00248}00248\ \textcolor{comment}{//\ eps\ :\ (l.omega\ -\/\ l\_int.omega)\ -\/\ (Ieta\ -\/\ Ieta\_int)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00249}00249\ \textcolor{comment}{//\ log\_norm\ :\ log[C(l,eta)\string^2]\ if\ is\_it\_normalized\ is\ false,\ 0.0\ if\ it\ is\ true.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00250}00250\ \textcolor{comment}{//\ two\_I\_Pi,\ two\_I\_Pi\_eps\ :\ 2.i.Pi,\ 2.i.Pi.eps\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00251}00251\ \textcolor{comment}{//\ log\_two\_I\_omega\ :\ log[2.i.omega]\ =\ log[2]\ +\ i.omega.Pi/2\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00252}00252\ \textcolor{comment}{//\ log\_cut\_constant\ :\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00253}00253\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00254}\mbox{\hyperlink{complex__functions_8_h_a6000662a6ef16a3e0de7dae0daa9f241}{00254}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a6000662a6ef16a3e0de7dae0daa9f241}{log\_cut\_constant\_CFa\_calc}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_it\_normalized,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00255}00255\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00256}00256\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (eta),real\ (eta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00257}00257\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ l\_int\ =\ rint\ (real\ (l)),\ Ieta\_int\ =\ rint\ (real\ (Ieta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00258}00258\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ eps\ =\ omega*(l\ -\/\ l\_int)\ -\/\ (Ieta\ -\/\ Ieta\_int);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00259}00259\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_norm\ =\ (!is\_it\_normalized)\ ?\ (2.0*\mbox{\hyperlink{complex__functions_8cpp_a049970d07da79ce7e09947878f7db115}{log\_Cl\_eta\_calc}}\ (l,eta))\ :\ (0.0);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00260}00260\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ two\_I\_Pi(0,2.0*M\_PI),two\_I\_Pi\_eps\ =\ two\_I\_Pi*eps,log\_two\_I\_omega(M\_LN2,omega*M\_PI\_2);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00262}00262\ \ \ \textcolor{keywordflow}{if}\ (real\ (two\_I\_Pi\_eps)\ <\ 0.1)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00263}00263\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00264}00264\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\ =\ log\_two\_I\_omega\ +\ log\ (\mbox{\hyperlink{complex__functions_8cpp_ade2fecd7fc202b30a4d210e46a27aa80}{expm1}}\ (two\_I\_Pi\_eps))\ +\ log\_norm;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00266}00266\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_cut\_constant;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00267}00267\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00268}00268\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00269}00269\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00270}00270\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\ =\ log\_two\_I\_omega\ +\ \mbox{\hyperlink{complex__functions_8cpp_a046207d48c55e2d6202da49b06039c49}{log1p}}\ (-\/exp\ (-\/two\_I\_Pi\_eps))\ +\ two\_I\_Pi\_eps\ +\ log\_norm;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00271}00271\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00272}00272\ \ \ \ \ \textcolor{keywordflow}{return}\ log\_cut\_constant;\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00273}00273\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00274}00274\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00275}00275\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00279}00279\ \textcolor{comment}{//\ Cut\ constant\ log\ for\ continued\ fractions\ :\ H[omega]\ from\ H[-\/omega,\ not\ corrected]\ case.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00280}00280\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00281}00281\ \textcolor{comment}{//\ The\ continued\ fraction\ has\ no\ cut\ on\ the\ negative\ real\ axis,\ whereas\ H[-\/omega]\ has\ one.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00282}00282\ \textcolor{comment}{//\ Then,\ if\ one\ is\ in\ the\ bad\ quadrant\ of\ H[-\/omega],\ one\ has\ to\ take\ into\ account\ the\ cut\ directly.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00283}00283\ \textcolor{comment}{//\ One\ is\ in\ the\ bad\ quadrant\ of\ H[-\/omega]\ if\ Re[z]\ <\ 0.0\ and\ sign(Im[z])\ =\ omega.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00284}00284\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00285}00285\ \textcolor{comment}{//\ H[omega]\ =\ H[-\/omega,\ not\ corrected]\ -\/\ cut\_constant.F\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00286}00286\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00287}00287\ \textcolor{comment}{//\ The\ cut\ constant\ is\ 2i.omega.norm.exp\ (-\/2.i.Pi.[l.omega\ +\ i.eta]),\ and\ one\ takes\ its\ log.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00288}00288\ \textcolor{comment}{//\ The\ returned\ imaginary\ part\ of\ the\ log\ is\ not\ necessarily\ in\ ]-\/Pi:Pi].}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00289}00289\ \textcolor{comment}{//\ Norm\ is\ 1.0\ for\ normalized\ wave\ functions,\ C(l,eta)\string^2\ for\ unnormalized\ wave\ functions.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00290}00290\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00291}00291\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00292}00292\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00293}00293\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00294}00294\ \textcolor{comment}{//\ is\_it\_normalized\ :\ true\ if\ one\ wants\ normalized\ functions,\ i.e.\ the\ standard\ normalization,}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00295}00295\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ false\ if\ one\ wants\ F\ -\/>\ F/C(l,eta)\ and\ H+/H-\//G\ -\/>\ H+/H-\//G.C(l,eta),\ to\ avoid\ overflows\ for\ |eta|\ >>\ 1\ and\ |z|\ small.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00296}00296\ \textcolor{comment}{//\ omega\ :\ 1\ or\ -\/1.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00297}00297\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00298}00298\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter\ =\ Coulomb\_constant.Z.(2.mu/hbar\string^2)/(2k).}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00299}00299\ \textcolor{comment}{//\ Ieta\ :\ i.eta\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00300}00300\ \textcolor{comment}{//\ l\_int,Ieta\_int\ :\ closest\ integers\ to\ Re[l],Re[i.eta]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00301}00301\ \textcolor{comment}{//\ eps\ :\ (l.omega\ -\/\ l\_int.omega)\ +\ (Ieta\ -\/\ Ieta\_int)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00302}00302\ \textcolor{comment}{//\ two\_I\_Pi\ :\ 2.i.Pi\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00303}00303\ \textcolor{comment}{//\ log\_norm\ :\ log[C(l,eta)\string^2]\ if\ is\_it\_normalized\ is\ false,\ 0.0\ if\ it\ is\ true.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00304}00304\ \textcolor{comment}{//\ log\_two\_I\_omega\ :\ log[2.i.omega]\ =\ log[2]\ +\ i.omega.Pi/2\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00305}00305\ \textcolor{comment}{//\ log\_cut\_constant\ :\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00306}00306\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00307}\mbox{\hyperlink{complex__functions_8_h_a51f7944e28f8f5084417467cd88fa129}{00307}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a51f7944e28f8f5084417467cd88fa129}{log\_cut\_constant\_CFb\_calc}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_it\_normalized,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00308}00308\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00309}00309\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (eta),real\ (eta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00310}00310\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ l\_int\ =\ rint\ (real\ (l)),\ Ieta\_int\ =\ rint\ (real\ (Ieta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00311}00311\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ eps\ =\ omega*(l\ -\/\ l\_int)\ +\ (Ieta\ -\/\ Ieta\_int);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00312}00312\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_norm\ =\ (!is\_it\_normalized)\ ?\ (2.0*\mbox{\hyperlink{complex__functions_8cpp_a049970d07da79ce7e09947878f7db115}{log\_Cl\_eta\_calc}}\ (l,eta))\ :\ (0.0);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00313}00313\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ two\_I\_Pi(0,2.0*M\_PI),log\_two\_I\_omega(M\_LN2,omega*M\_PI\_2),log\_cut\_constant\ =\ log\_two\_I\_omega\ -\/\ two\_I\_Pi*eps\ +\ log\_norm;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00314}00314\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00315}00315\ \ \ \textcolor{keywordflow}{return}\ log\_cut\_constant;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00316}00316\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00317}00317\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00318}00318\ \textcolor{comment}{//\ Sin\ (chi)\ calculation}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00319}00319\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00320}00320\ \textcolor{comment}{//\ If\ 2l\ is\ integer,\ 0.0\ is\ returned\ as\ chi\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00321}00321\ \textcolor{comment}{//\ If\ not,\ one\ calculates\ sin\ (chi)\ with\ chi\ =\ sigma(l,eta)\ -\/\ sigma(-\/l-\/1,eta)\ -\/\ (l+1/2).Pi\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00322}00322\ \textcolor{comment}{//\ One\ uses\ the\ stable\ formula\ sin\ (chi)\ =\ -\/(2l+1).C(l,eta).C(-\/l-\/1,eta).}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00323}00323\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00324}00324\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00325}00325\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00326}00326\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00327}00327\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00328}00328\ \textcolor{comment}{//\ sin\_chi\ :\ sin\ (chi)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00329}00329\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00330}\mbox{\hyperlink{complex__functions_8_h_a9faa37765d52edca76952f239376f53e}{00330}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a9faa37765d52edca76952f239376f53e}{sin\_chi\_calc}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00331}00331\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00332}00332\ \ \ \textcolor{keywordflow}{if}\ (rint\ (real\ (2.0*l))\ ==\ 2.0*l)\ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00333}00333\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00334}00334\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sin\_chi\ =\ -\/(2*l+1)*exp\ (\mbox{\hyperlink{complex__functions_8cpp_a049970d07da79ce7e09947878f7db115}{log\_Cl\_eta\_calc}}\ (l,eta)\ +\ \mbox{\hyperlink{complex__functions_8cpp_a049970d07da79ce7e09947878f7db115}{log\_Cl\_eta\_calc}}\ (-\/l-\/1,eta));}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00335}00335\ \ \ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00336}00336\ \ \ \textcolor{keywordflow}{return}\ sin\_chi;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00337}00337\ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00338}00338\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00339}00339\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00340}00340\ \textcolor{comment}{//\ exp\ (i.omega.chi)\ calculation.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00341}00341\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00342}00342\ \textcolor{comment}{//\ One\ calculates\ exp\ (i.omega.chi),\ with\ chi\ =\ sigma(l,eta)\ -\/\ sigma(l,-\/eta)\ -\/\ (l+1/2).Pi\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00343}00343\ \textcolor{comment}{//\ If\ 2l\ is\ integer,\ 1.0\ is\ returned\ as\ chi\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00344}00344\ \textcolor{comment}{//\ If\ not,\ one\ first\ calculates\ sin\ (chi)\ with\ the\ previous\ routine.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00345}00345\ \textcolor{comment}{//\ If\ |sin\ (chi)|\ >\ 0.5,\ chi\ obtained\ with\ the\ formula\ sigma(l,eta)\ -\/\ sigma(l,-\/eta)\ -\/\ (l+1/2).Pi\ is\ stable\ so\ exp[i.omega.chi]\ follows\ directly.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00346}00346\ \textcolor{comment}{//\ If\ not,\ one\ uses\ exp[i.omega.chi]\ =\ cos\ (chi)\ +\ i.omega.sin\ (chi),\ with\ cos\ (chi)\ =\ sqrt\ [1\ -\/\ sin\ (chi)*sin\ (chi)].sign[Re[cos\ (chi)]],}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00347}00347\ \textcolor{comment}{//\ with\ chi\ given\ by\ sigma(l,eta)\ -\/\ sigma(l,-\/eta)\ -\/\ (l+1/2).Pi\ .}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00348}00348\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00349}00349\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00350}00350\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00351}00351\ \textcolor{comment}{//\ omega\ :\ 1\ or\ -\/1}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00352}00352\ \textcolor{comment}{//\ l\ :\ orbital\ angular\ momentum\ l.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00353}00353\ \textcolor{comment}{//\ eta\ :\ Sommerfeld\ parameter\ =\ Coulomb\_constant.Z.(2.mu/hbar\string^2)/(2k).}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00354}00354\ \textcolor{comment}{//\ I\_omega\ :\ i.omega}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00355}00355\ \textcolor{comment}{//\ sin\_chi\ :\ sin\ (chi)}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00356}00356\ \textcolor{comment}{//\ chi\ :\ sigma(l,eta)\ -\/\ sigma(l,-\/eta)\ -\/\ (l+1/2).Pi\ .\ }}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00357}00357\ \textcolor{comment}{//\ cos\_chi\ :\ sign[Re[cos\ (chi)]].sqrt[1\ -\/\ [sin(chi)]\string^2]}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00358}00358\ \textcolor{comment}{//\ exp\_I\_omega\_chi\ :\ exp[i.omega.chi],\ returned\ result.}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00359}00359\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00360}\mbox{\hyperlink{complex__functions_8_h_a761f51fb938d3c8150a43aa2a3da77ff}{00360}}\ std::complex<double>\ \mbox{\hyperlink{complex__functions_8cpp_a761f51fb938d3c8150a43aa2a3da77ff}{exp\_I\_omega\_chi\_calc}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&l,\textcolor{keyword}{const}\ std::complex<double>\ \&eta)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00361}00361\ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00362}00362\ \ \ \textcolor{keywordflow}{if}\ (rint\ (real\ (2.0*l))\ ==\ 2.0*l)\ \textcolor{keywordflow}{return}\ 1.0;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00364}00364\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0,omega),sin\_chi\ =\ \mbox{\hyperlink{complex__functions_8cpp_a9faa37765d52edca76952f239376f53e}{sin\_chi\_calc}}\ (l,eta);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00365}00365\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ chi\ =\ \mbox{\hyperlink{complex__functions_8cpp_aed60e5bab259589d13c0b2922aed0521}{sigma\_l\_calc}}\ (l,eta)\ -\/\ \mbox{\hyperlink{complex__functions_8cpp_aed60e5bab259589d13c0b2922aed0521}{sigma\_l\_calc}}\ (-\/l-\/1,eta)\ -\/\ (l+0.5)*M\_PI;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00367}00367\ \ \ \textcolor{keywordflow}{if}\ (abs\ (sin\_chi)\ >\ 0.5)}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00368}00368\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00369}00369\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ exp\_I\_omega\_chi\ =\ exp\ (I\_omega*chi);}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00371}00371\ \ \ \ \ \textcolor{keywordflow}{return}\ exp\_I\_omega\_chi;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00372}00372\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00373}00373\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00374}00374\ \ \ \{}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00375}00375\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ cos\_chi\ =\ \mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (cos\ (chi)))*sqrt\ (1.0\ -\/\ sin\_chi*sin\_chi),exp\_I\_omega\_chi\ =\ cos\_chi\ +\ I\_omega*sin\_chi;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00376}00376\ }
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00377}00377\ \ \ \ \ \textcolor{keywordflow}{return}\ exp\_I\_omega\_chi;}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00378}00378\ \ \ \}}
\DoxyCodeLine{\Hypertarget{complex__functions_8cpp_source_l00379}00379\ \}}

\end{DoxyCode}
