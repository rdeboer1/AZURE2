\doxysection{cwfcomp.\+cpp}
\hypertarget{cwfcomp_8cpp_source}{}\label{cwfcomp_8cpp_source}\index{/Users/kuba/Desktop/R-\/Matrix/AZURE2/coul/src/cwfcomp.cpp@{/Users/kuba/Desktop/R-\/Matrix/AZURE2/coul/src/cwfcomp.cpp}}
\mbox{\hyperlink{cwfcomp_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cwfcomp_8_h}{cwfcomp.H}}"{}}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00003}00003\ \textcolor{comment}{//\ Calculation\ of\ h(omega)\ =\ H(omega)'/H(omega)\ with\ a\ continued\ fraction.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00004}00004\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00005}00005\ \textcolor{comment}{//\ One\ calculates\ the\ ratio\ h\ =\ H'/H\ with\ the\ continued\ fraction\ of\ the\ associated\ hypergeometric\ confluent\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00006}00006\ \textcolor{comment}{//\ One\ uses\ Lentz's\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00007}00007\ \textcolor{comment}{//\ One\ has\ :\ h\ =\ [b[0]\ +\ a[1]/b[1]+\ a[2]/b[2]+\ ...\ a[n]/b[n]+\ ...].i.omega/z\ with\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00008}00008\ \textcolor{comment}{//\ b[0]\ =\ z\ -\/\ eta,\ a[n]\ =\ (1\ +\ l\ +\ i.omega\ +\ n-\/1).(i.omega.eta\ -\/\ l\ +\ n-\/1),\ b[n]\ =\ 2[z\ -\/\ eta]\ +\ i.omega.n\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00009}00009\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00010}00010\ \textcolor{comment}{//\ If\ the\ number\ of\ iterations\ reaches\ 100000\ and\ |z|\ >\ 0.5,\ the\ convergence\ is\ too\ slow.\ One\ is\ probably\ very\ close\ to\ the\ imaginary\ axis.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00011}00011\ \textcolor{comment}{//\ If\ l=0\ and\ |z|\ <=\ 0.5,\ the\ direct\ integration\ is\ still\ done\ as\ it\ is\ stable.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00012}00012\ \textcolor{comment}{//\ If\ 1+l+/-\/i.eta\ is\ negative\ integer,\ it\ has\ to\ be\ done\ otherwise\ it\ is\ too\ long\ even\ if\ |z|\ is\ not\ exceedingly\ small.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00013}00013\ \textcolor{comment}{//\ One\ first\ considers\ Re[z]\ >=\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00014}00014\ \textcolor{comment}{//\ One\ takes\ the\ starting\ point\ z0\ =\ 2\ +\ i.(Im[z]\ +\ 2.sign[Im[z]])\ (0.6\ +\ i.sign[Re[z]].0.6.sign[Im[z]]\ if\ |z|\ <=\ 0.5).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00015}00015\ \textcolor{comment}{//\ Then,\ one\ calculates\ H[omega],H[omega]'\ at\ the\ starting\ point,\ and\ one\ integrates\ numerically\ H[omega]\ until\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00016}00016\ \textcolor{comment}{//\ h(omega)(z)\ is\ then\ H[omega](z)'/H[omega](z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00017}00017\ \textcolor{comment}{//\ If\ Re[z]\ <\ 0,\ one\ calculates\ H[-\/omega],H[-\/omega]'\ with\ l,\ eta\ -\/>\ -\/eta,\ and\ z\ -\/>\ -\/z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00018}00018\ \textcolor{comment}{//\ One\ uses\ the\ Coulomb\ wave\ functions\ class\ cwf\_minus\_eta\_ptr\ defined\ with\ l\ and\ -\/eta.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00019}00019\ \textcolor{comment}{//\ The\ ratio\ h(omega,l,eta,z)\ is\ then\ equal\ to\ -\/h(-\/omega,l,-\/eta,-\/z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00020}00020\ \textcolor{comment}{//\ To\ avoid\ infinite\ loops,\ continued\_fraction\_h\ must\ not\ be\ used\ in\ this\ integration.\ So,\ the\ starting\ point\ is\ chosen\ so\ |H[+/-\/]|\ is\ very\ likely}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00021}00021\ \textcolor{comment}{//\ to\ increase\ in\ modulus.\ Then,\ one\ always\ integrates\ forward.\ Forward\ integration\ is\ enforced\ putting}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00022}00022\ \textcolor{comment}{//\ is\_H\_dir\_int\_naive\ to\ true.\ It\ is\ put\ to\ false\ again\ at\ the\ end\ of\ the\ calculation.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00023}00023\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00024}00024\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00025}00025\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00026}00026\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00027}00027\ \textcolor{comment}{//\ omega\ :\ 1\ for\ the\ outgoing\ wave\ function\ ratio\ H+'/H+,\ -\/1\ for\ the\ incoming\ wave\ function\ ratio\ H-\/'/H-\/.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00028}00028\ \textcolor{comment}{//\ large,small\ :\ 1E50,1E-\/50.\ They\ are\ used\ in\ the\ case\ of\ vanishing\ denominators\ or\ numerators.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00029}00029\ \textcolor{comment}{//\ I\_omega,I\_omega\_eta,two\_I\_omega,z\_minus\_eta,two\_z\_minus\_eta\ :\ i.omega,i.omega.eta,\ 2.i.omega,\ z-\/eta,\ 2(z-\/eta).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00030}00030\ \textcolor{comment}{//\ a,c\ :\ 1\ +\ l\ +\ i.omega.eta,\ i.omega.eta\ -\/\ l.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00031}00031\ \textcolor{comment}{//\ b0,Cn,Dn,an,bn,Delta\_n\ :\ variables\ used\ in\ the\ Lentz\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00032}00032\ \textcolor{comment}{//\ n,nm1\ :\ index\ of\ a[n]\ and\ b[n],\ n-\/1\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00033}00033\ \textcolor{comment}{//\ bn\_plus\_an\_Dn\ :\ bn\ +\ an.Dn.\ Dn\ =\ 1/[bn\ +\ an.Dn]\ or\ 1E50\ if\ bn\ +\ an.Dn\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00034}00034\ \textcolor{comment}{//\ bn\_plus\_an\_over\_Cn\ :\ bn\ +\ an/Cn.\ Cn\ =\ bn\ +\ an/Dn\ or\ 1E-\/50\ if\ bn\ +\ an/Dn\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00035}00035\ \textcolor{comment}{//\ hn\ :\ value\ of\ the\ continuous\ fraction\ during\ the\ iteration\ process.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00036}00036\ \textcolor{comment}{//\ test\ :\ test\ of\ convergence\ of\ hn.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00037}00037\ \textcolor{comment}{//\ cwf\ :\ reference\ to\ *this\ if\ Re[z]\ >=\ 0,\ reference\ to\ cwf\_minus\_eta\_ptr\ if\ Re[z]\ <\ 0}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00038}00038\ \textcolor{comment}{//\ \ \ \ \ \ \ cwf\_minus\_eta\_ptr\ is\ allocated\ first\ if\ it\ is\ zero,\ in\ the\ case\ of\ Re[z]\ <\ 0\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00039}00039\ \textcolor{comment}{//\ \ \ \ \ \ \ It\ is\ used\ to\ integrate\ the\ Coulomb\ wave\ functions\ with\ l,eta\ for\ Re[z]\ >=\ 0\ or\ l,-\/eta\ for\ Re[z]\ <\ 0.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00040}00040\ \textcolor{comment}{//\ z00\ :\ 2\ +\ i.sign[Re[z]].(Im[z]\ +\ 2.sign[Im[z]]).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00041}00041\ \textcolor{comment}{//\ z01\ :\ 0.6\ +\ i.0.6.sign[Re[z]].sign[Im[z]].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00042}00042\ \textcolor{comment}{//\ abs\_z\ :\ |z|}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00043}00043\ \textcolor{comment}{//\ z\_start,F\_start,dF\_start\ :\ starting\ point\ of\ the\ direct\ integration,\ F(l,+/-\/eta,z\_start),F'(l,+/-\/eta,z\_start)\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00044}00044\ \textcolor{comment}{//\ H,dH\ :\ Coulomb\ wave\ function\ and\ derivative\ in\ l,eta,omega,z\ if\ Re[z]\ >\ 0,\ in\ l,-\/eta,-\/omega,-\/z\ if\ Re[z]\ <\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00045}00045\ \textcolor{comment}{//\ h\ :\ value\ of\ H(omega)'/H(omega).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00046}00046\ \textcolor{comment}{//\ debut\_cwf,F\_debut\_cwf,dF\_debut\_cwf\ :\ values\ stored\ in\ cwf\ put\ back\ in\ cwf\ at\ the\ end\ of\ direct\ integration\ as\ they\ change\ values.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00047}00047\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00048}00048\ std::complex<double>\ Coulomb\_wave\_functions::continued\_fraction\_h\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00049}00049\ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00050}00050\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ small\ =\ 1E-\/50,large\ =\ 1E50,abs\_z\ =\ abs\ (z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00051}00051\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0.0,omega),two\_I\_omega(0.0,2.0*omega),I\_omega\_eta\ =\ I\_omega*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00052}00052\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ a\ =\ I\_omega\_eta\ +\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 1.0,c\ =\ I\_omega\_eta\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}},z\_minus\_eta\ =\ z\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}},two\_z\_minus\_eta\ =\ 2.0*z\_minus\_eta;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00054}00054\ \ \ std::complex<double>\ b0\ =\ z\_minus\_eta,hn\ =\ (b0\ !=\ 0.0)\ ?\ (b0)\ :\ (1E-\/50),\ Cn\ =\ hn,\ Dn\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00055}00055\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00056}00056\ \ \ \textcolor{keywordtype}{double}\ test;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00057}00057\ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00058}00058\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00059}00059\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nm1\ =\ n-\/1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00060}00060\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ an\ =\ (a\ +\ nm1)*(c\ +\ nm1),bn\ =\ two\_z\_minus\_eta\ +\ n*two\_I\_omega,bn\_plus\_an\_Dn\ =\ bn\ +\ an*Dn,bn\_plus\_an\_over\_Cn\ =\ bn\ +\ an/Cn;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00062}00062\ \ \ \ \ Dn\ =\ (bn\_plus\_an\_Dn\ !=\ 0.0)\ ?\ (1.0/bn\_plus\_an\_Dn)\ :\ (large);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00063}00063\ \ \ \ \ Cn\ =\ (bn\_plus\_an\_over\_Cn\ !=\ 0.0)\ ?\ (bn\_plus\_an\_over\_Cn)\ :\ (small);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00065}00065\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Delta\_n\ =\ Dn*Cn;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00066}00066\ \ \ \ \ hn\ *=\ Delta\_n;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00067}00067\ \ \ \ \ test\ =\ \mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (1.0\ -\/\ Delta\_n);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00068}00068\ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00069}00069\ \ \ \ \ \textcolor{keywordflow}{if}\ ((n++\ >\ 100000)\ \&\&\ ((\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ ==\ 0.0)\ ||\ (abs\_z\ >\ 0.5)\ ||\ neg\_int\_omega\_one\ ||\ neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00070}00070\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00071}00071\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((real\ (z)\ <\ 0.0)\ \&\&\ (cwf\_minus\_eta\_ptr\ ==\ 0))\ cwf\_minus\_eta\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}},-\/\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00072}00072\ \ \ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ \&cwf\ =\ (real\ (z)\ <\ 0.0)\ ?\ (*cwf\_minus\_eta\_ptr)\ :\ (*this);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00073}00073\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00074}00074\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z00(2.0,\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (z))*(imag\ (z)\ +\ 2.0*\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (imag\ (z)))),z01(0.6,0.6*\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (z))*\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (imag\ (z)));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00075}00075\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_start\ =\ (abs\_z\ >\ 0.5)\ ?\ (z00)\ :\ (z01),debut\_cwf\ =\ cwf.debut,F\_debut\_cwf\ =\ cwf.F\_debut,dF\_debut\_cwf\ =\ cwf.dF\_debut;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00076}00076\ \ \ \ \ \ \ std::complex<double>\ F\_start,dF\_start,H,dH;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00077}00077\ \ \ \ \ \ \ cwf.\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z\_start,F\_start,dF\_start);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00078}00078\ \ \ \ \ \ \ cwf.is\_H\_dir\_int\_naive\ =\ \textcolor{keyword}{true},\ cwf.H\_dH\_direct\_integration\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (z))*omega,\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (z))*z,H,dH),\ cwf.is\_H\_dir\_int\_naive\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00079}00079\ \ \ \ \ \ \ cwf.debut\ =\ debut\_cwf,\ cwf.F\_debut\ =\ F\_debut\_cwf,\ cwf.dF\_debut\ =\ dF\_debut\_cwf;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00080}00080\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (real\ (z))*dH/H);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00081}00081\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00082}00082\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00083}00083\ \ \ \textcolor{keywordflow}{while}\ (test\ >\ 1E-\/15);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00085}00085\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\ =\ hn*I\_omega/z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00086}00086\ \ \ \textcolor{keywordflow}{return}\ h;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00087}00087\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00092}00092\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00098}00098\ \textcolor{comment}{//\ Calculation\ of\ H(omega)\ and\ dH(omega)/dz\ (scaled)\ with\ asymptotic\ series}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00099}00099\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00100}00100\ \textcolor{comment}{//\ H[omega](z)\ =\ exp[i.omega.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].S[omega](z)\ for\ Re[z]\ >=\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00101}00101\ \textcolor{comment}{//\ H[omega]'(z)\ =\ exp[i.omega.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].[S[omega]'(z)\ +\ i.omega.(1\ -\/\ eta/z).S[omega](z)]\ for\ Re[z]\ >=\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00102}00102\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00103}00103\ \textcolor{comment}{//\ S[omega](z)\ is\ the\ asymptotic\ series\ and\ S[omega]'(z)\ its\ derivative\ calculated\ in\ asymptotic\_series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00104}00104\ \textcolor{comment}{//\ If\ they\ did\ not\ converge,\ one\ leaves\ the\ routine.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00105}00105\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00106}00106\ \textcolor{comment}{//\ The\ negative\ cut\ is\ taken\ into\ account\ if\ log\ [cut\_constant\_AS]\ is\ finite,\ i.e.\ cut\_constant\_AS\ is\ not\ exactly\ zero\ :\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00107}00107\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00108}00108\ \textcolor{comment}{//\ If\ Re[z]\ <\ 0.0\ and\ omega.Im[z]\ <\ 0.0\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00109}00109\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00110}00110\ \textcolor{comment}{//\ H[omega]\ =\ H[omega][ASd]\ +\ cut\_constant\_AS\_plus.H[-\/omega][ASd].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00111}00111\ \textcolor{comment}{//\ H[omega][ASd]\ is\ given\ by\ directly\ by\ the\ asymptotic\ series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00112}00112\ \textcolor{comment}{//\ H[-\/omega][ASd]\ is\ given\ by\ the\ asymptotic\ series,\ which\ gives\ the\ good\ result\ H[-\/omega]\ in\ this\ case\ as\ one\ is\ not\ in\ its\ bad\ quadrant.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00113}00113\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00114}00114\ \textcolor{comment}{//\ The\ function\ is\ scaled,\ so\ one\ returns\ :\ H[omega](z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]]]\ and\ H[omega]'(z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]]]\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00115}00115\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00116}00116\ \textcolor{comment}{//\ In\ the\ case\ of\ overflows\ or\ underflows,\ one\ uses\ logs.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00117}00117\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00118}00118\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00119}00119\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00120}00120\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00121}00121\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00122}00122\ \textcolor{comment}{//\ one\_over\_z\ :\ 1/z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00123}00123\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00124}00124\ \textcolor{comment}{//\ H\_scaled,dH\_scaled\ :\ H[omega](z).exp(-\/i.omega.[z\ -\/\ eta.log[2z]])\ and\ H[omega]'(z).exp(-\/iomega.[z\ -\/\ eta.log[2z]]).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00125}00125\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ asymptotic\ expansions\ converged,\ false\ it\ not}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00126}00126\ \textcolor{comment}{//\ sum,dsum\ :\ \{S[omega](z),S[-\/omega](z)\}\ and\ \{S[omega]'(z),S[-\/omega]'(z)\}}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00127}00127\ \textcolor{comment}{//\ I\_omega,two\_I\_omega\ :\ i.omega,\ 2i.omega.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00128}00128\ \textcolor{comment}{//\ I\_omega\_one\_minus\_eta\_over\_z\ :\ i.omega.(1\ -\/\ eta/z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00129}00129\ \textcolor{comment}{//\ phase\_shift\ :\ i.omega.[-\/l.Pi/2\ +\ sigma(l,eta)]}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00130}00130\ \textcolor{comment}{//\ exp\_phase\_shift\ :\ exp\ (i.omega.(-\/l.Pi/2\ +\ sigma(l,eta))).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00131}00131\ \textcolor{comment}{//\ log\_cut\_constant\_AS\ :\ log\_cut\_constant\_AS\_plus\ if\ omega\ =\ 1,\ log\_cut\_constant\_AS\_minus\ if\ omega\ =-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00132}00132\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ log\_cut\_constant\_AS\ is\ not\ finite\ (i.e.\ cut\_constant\_AS\ =\ 0\ if\ it\ is\ defined),\ there\ is\ no\ branch\ cut\ to\ consider.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00133}00133\ \textcolor{comment}{//\ factor\ :\ exp\ (log\_cut\_constant\_AS\ -\/\ 2.i.omega.(z\ -\/\ eta.log(2z))\ -\/\ phase\_shift).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00134}00134\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00135}00135\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::asymptotic\_expansion\_H\_dH\_scaled\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&one\_over\_z,}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::complex<double>\ \&H\_scaled,std::complex<double>\ \&dH\_scaled,\textcolor{keywordtype}{bool}\ \&is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00137}00137\ \{\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00138}00138\ \ \ std::complex<double>\ sum[2],dsum[2];}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00140}00140\ \ \ asymptotic\_series\ (omega,one\_over\_z,sum,dsum,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00141}00141\ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00143}00143\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0,omega),two\_I\_omega(0,2*omega),I\_omega\_one\_minus\_eta\_over\_z\ =\ I\_omega*(1.0\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*one\_over\_z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00145}00145\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ phase\_shift\ =\ I\_omega*(sigma\_l\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}*M\_PI\_2),exp\_phase\_shift\ =\ exp\ (phase\_shift);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00146}00146\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00147}00147\ \ \ H\_scaled\ =\ sum[0]*exp\_phase\_shift;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00148}00148\ \ \ dH\_scaled\ =\ (dsum[0]\ +\ sum[0]*I\_omega\_one\_minus\_eta\_over\_z)*exp\_phase\_shift;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00150}00150\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\_AS\ =\ (omega\ ==\ 1)\ ?\ (log\_cut\_constant\_AS\_plus)\ :\ (log\_cut\_constant\_AS\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00152}00152\ \ \ \textcolor{keywordflow}{if}\ (one\_over\_z\ !=\ 0.0)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00153}00153\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00154}00154\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\ =\ 1.0/one\_over\_z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00155}00155\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00156}00156\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (log\_cut\_constant\_AS)\ \&\&\ (real\ (z)\ <\ 0.0)\ \&\&\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (imag\ (z))\ ==\ -\/omega))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00157}00157\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00158}00158\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ factor\ =\ exp\ (-\/two\_I\_omega*(z\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*(M\_LN2\ +\ log\ (z)))\ -\/\ phase\_shift\ +\ log\_cut\_constant\_AS);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00160}00160\ \ \ \ \ \ \ H\_scaled\ +=\ sum[1]*factor;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00161}00161\ \ \ \ \ \ \ dH\_scaled\ +=\ (dsum[1]\ -\/\ sum[1]*I\_omega\_one\_minus\_eta\_over\_z)*factor;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00162}00162\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00163}00163\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00164}00164\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00165}00165\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00166}00166\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00167}00167\ \ \ \ \ \textcolor{keywordflow}{if}\ ((Cl\_eta\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (Cl\_eta)))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00168}00168\ \ \ \ \ \ \ H\_scaled\ =\ exp\ (log\_Cl\_eta\ +\ log\ (H\_scaled)),dH\_scaled\ =\ exp\ (log\_Cl\_eta\ +\ log\ (dH\_scaled));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00169}00169\ \ \ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00170}00170\ \ \ \ \ \ \ H\_scaled\ *=\ Cl\_eta,dH\_scaled\ *=\ Cl\_eta;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00171}00171\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00172}00172\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00175}00175\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00176}00176\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00179}00179\ \textcolor{comment}{//\ Calculation\ of\ H[omega](z)\ and\ H[omega]'(z)\ by\ direct\ integration.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00180}00180\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00181}00181\ \textcolor{comment}{//\ To\ calculate\ H[omega](z)\ and\ H'[omega](z),\ one\ integrates\ numerically\ H[omega]''(z)\ =\ [l(l+1)/z\string^2\ +\ 2.eta/z\ -\/\ 1].H[omega](z)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00182}00182\ \textcolor{comment}{//\ starting\ from\ debut,H\_debut\ =\ H[omega](debut)\ and\ dH\_debut\ =\ H'[omega](debut).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00183}00183\ \textcolor{comment}{//\ There\ is\ no\ branch\ cut\ problem\ as\ Re[z]\ >=\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00184}00184\ \textcolor{comment}{//\ The\ starting\ point\ comes\ for\ the\ regular\ function\ from\ the\ stored\ values\ debut,\ F\_debut\ and\ dF\_debut.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00185}00185\ \textcolor{comment}{//\ If\ debut\ =\ 0,\ one\ puts\ debut\ =\ debut\_omega\ =\ z/|2z|\ and\ calculates\ F(debut)\ and\ F'(debut)\ with\ power\ series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00186}00186\ \textcolor{comment}{//\ Then,\ the\ starting\ point\ \{debut\_omega,H[omega](debut),H'[omega](debut)\}\ is\ calculated\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00187}00187\ \textcolor{comment}{//\ from\ \{debut,F(debut),F'(debut)\}\ and\ the\ continued\ fraction\ h[omega](debut).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00188}00188\ \textcolor{comment}{//\ The\ first\ order\ expansions\ method\ is\ used\ if\ one\ is\ very\ close\ to\ the\ real\ axes\ of\ l,eta\ and\ z\ (Re[z]\ >\ 0).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00189}00189\ \textcolor{comment}{//\ The\ step\ of\ the\ integration\ is\ (z\ -\/\ debut)/N\_num,\ with\ N\_num\ =\ [|z\ -\/\ debut|/min\ (0.1,10.turning\_point)]\ +\ 1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00190}00190\ \textcolor{comment}{//\ The\ value\ of\ min\ (0.1,10/turning\_point)\ gives\ a\ smaller\ step\ when\ turning\_point\ increases,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00191}00191\ \textcolor{comment}{//\ as\ calculations\ become\ there\ more\ difficult\ as\ |H[omega]|\ typically\ varies\ faster\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00192}00192\ \textcolor{comment}{//\ The\ intermediates\ points\ are\ called\ z\_aft.\ They\ go\ from\ debut\ to\ z,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00193}00193\ \textcolor{comment}{//\ and\ (debut\_omega,H\_debut,dH\_debut)\ is\ put\ to\ \{z\_aft,H[omega](z\_aft),H'[omega](z\_aft)\}\ at\ each\ step.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00194}00194\ \textcolor{comment}{//\ If\ |H[omega]|\ increases\ along\ the\ path,\ the\ integration\ is\ stable.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00195}00195\ \textcolor{comment}{//\ If\ is\_H\_dir\_int\_naive\ is\ true,\ one\ has\ to\ integrate\ forward,\ as\ this\ integration\ is\ used\ to\ calculate\ the\ continued\ fraction.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00196}00196\ \textcolor{comment}{//\ If\ not,\ and\ if\ |H[omega]|\ decreases,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00197}00197\ \textcolor{comment}{//\ one\ integrates\ backwards\ from\ z\_aft\ to\ debut\_omega\ with\ the\ knowledge\ of\ h[omega](z\_aft)\ =\ H'[omega](z\_aft)/H[omega](z\_aft).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00198}00198\ \textcolor{comment}{//\ H'[omega](z\_aft)/H[omega](z\_aft)\ is\ given\ by\ the\ continued\ fraction\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00199}00199\ \textcolor{comment}{//\ One\ then\ obtains\ by\ direct\ integration\ C.H[omega](debut)\ and\ C.H'[omega](debut).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00200}00200\ \textcolor{comment}{//\ Knowing\ H\_debut,\ one\ deduces\ H[omega](z)\ =\ 1/C\ and\ H'[omega](z)\ =\ f(z\_aft).H[omega](z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00201}00201\ \textcolor{comment}{//\ Increase\ or\ decrease\ is\ known\ using\ the\ Taylor\ expansion\ of\ H[omega]\ near\ debut\_omega\ in\ z\ up\ to\ second\ order.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00202}00202\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00203}00203\ \textcolor{comment}{//\ If\ H(z\_aft)\ is\ not\ finite,\ one\ stops\ the\ integration.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00204}00204\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00205}00205\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00206}00206\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00207}00207\ \textcolor{comment}{//\ omega\ :\ 1\ for\ H+,H+',\ -\/1\ for\ H-\/,H-\/'.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00208}00208\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00209}00209\ \textcolor{comment}{//\ H,dH\ :\ wave\ function\ H[omega]\ and\ derivative\ H'[omega]\ to\ calculate.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00210}00210\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00211}00211\ \textcolor{comment}{//\ debut\_omega,\ H\_debut,dH\_debut\ :\ starting\ point\ or\ the\ integration.\ debut\_omega\ =\ debut\ at\ the\ beginning.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00212}00212\ \textcolor{comment}{//\ ODE\ :\ reference\ to\ pointer\ ODE\_ptr,\ which\ performs\ direct\ integration\ from\ one\ point\ to\ another.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00213}00213\ \textcolor{comment}{//\ step\_abs\ :\ length\ of\ the\ integration\ step\ from\ z\ to\ debut.\ It\ is\ min\ (0.1,10/turning\_point)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00214}00214\ \textcolor{comment}{//\ N\_num\ :\ number\ of\ integrations\ to\ do\ from\ debut\ to\ z.\ It\ is\ |z\ -\/\ debut|/step\_abs\ +\ 1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00215}00215\ \textcolor{comment}{//\ step\_num\ :\ std::complex\ step\ from\ debut\ to\ z.\ It\ is\ (z\ -\/\ debut)/N\_num\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00216}00216\ \textcolor{comment}{//\ ll\_plus\_one,two\_eta\ :\ l(l+1),\ 2.eta.\ They\ are\ used\ in\ the\ Taylor\ expansion\ test.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00217}00217\ \textcolor{comment}{//\ z\_aft\ :\ next\ point\ in\ which\ H[omega]\ is\ calculated\ by\ direct\ integration\ .\ It\ is\ z\ -\/\ i*step\_num,\ with\ i\ from\ N\_num-\/1\ to\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00218}00218\ \textcolor{comment}{//\ one\_over\_debut,log\_H\_debut\_der,d2H\_debut\_over\_H\_debut:\ 1/debut,\ H'[omega](debut)/H[omega](debut),\ H[omega]''(debut)/H[omega](debut).\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00219}00219\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ They\ are\ used\ in\ the\ Taylor\ expansion\ test.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00220}00220\ \textcolor{comment}{//\ h\ :\ continued\ fraction\ h[omega]\ =\ H[omega]'/H[omega]\ in\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00221}00221\ \textcolor{comment}{//\ H\_debut\_not\_normed,dH\_debut\_not\_normed\ :\ unnormed\ regular\ wave\ function\ and\ derivative\ in\ debut\_omega,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00222}00222\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ after\ integration\ from\ the\ starting\ point\ \{z\_aft,\ 1.0,\ H'[omega](z\_aft)/H[omega](z\_aft)\}.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00223}00223\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Then,\ H[omega](z\_aft)\ =\ \ H\_debut/H\_debut\_not\_normed\ and\ H'[omega](z\_aft)\ =\ h[omega].H[omega](z\_aft)\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00225}00225\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::H\_dH\_direct\_integration\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H,std::complex<double>\ \&dH)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00226}00226\ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00227}00227\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00228}00228\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00229}00229\ \ \ \textcolor{keywordflow}{if}\ (debut\ ==\ 0.0)\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00230}00230\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00231}00231\ \ \ \ \ debut\ =\ 0.5*z/abs\ (z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00232}00232\ \ \ \ \ F\_dF\_power\_series\ (debut,F\_debut,dF\_debut);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00233}00233\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00234}00234\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00235}00235\ \ \ std::complex<double>\ debut\_omega\ =\ debut,H\_debut,dH\_debut;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00236}00236\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00237}00237\ \ \ \textcolor{keywordflow}{if}\ (((y\ !=\ 0.0)\ ||\ (eta\_i\ !=\ 0.0)\ ||\ (l\_i\ !=\ 0.0))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00238}00238\ \ \ \ \ \ \ \&\&\ (std::abs\ (y)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}}*std::min\ (1.0,x))\ \&\&\ (std::abs\ (eta\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})\ \&\&\ (std::abs\ (l\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00239}00239\ \ \ \ \ \ \ \&\&\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00240}00240\ \ \ \ \ first\_order\_expansions\ (omega,debut\_omega,H\_debut,dH\_debut);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00241}00241\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00242}00242\ \ \ \ \ H\_dH\_with\_F\_dF\_and\_CF\ (omega,debut\_omega,H\_debut,dH\_debut);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00243}00243\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00244}00244\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_o_d_e__integration}{ODE\_integration}}\ \&ODE\ =\ *ODE\_ptr;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00245}00245\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ step\_abs\ =\ std::min(0.1,10.0/turning\_point);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00246}00246\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ N\_num\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\textcolor{keyword}{>}\ ((abs\ (z-\/debut\_omega)/step\_abs)\ +\ 1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00247}00247\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ step\_num\ =\ (z\ -\/\ debut\_omega)/\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}\ (N\_num),ll\_plus\_one\ =\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}*(\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0),two\_eta\ =\ 2.0*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00248}00248\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00249}00249\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ N\_num-\/1\ ;\ i\ <=\ N\_num\ ;\ i-\/-\/)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00250}00250\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00251}00251\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_aft\ =\ z\ -\/\ i*step\_num,one\_over\_debut\ =\ 1.0/debut,log\_H\_debut\_der\ =\ dH\_debut/H\_debut;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00252}00252\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ d2H\_debut\_over\_H\_debut\ =\ (ll\_plus\_one*one\_over\_debut\ +\ two\_eta)*one\_over\_debut\ -\/\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00253}00253\ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00254}00254\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_H\_dir\_int\_naive)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00255}00255\ \ \ \ \ \ \ ODE\ (debut\_omega,H\_debut,dH\_debut,z\_aft,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00256}00256\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (abs\ (1.0\ +\ step\_num*(log\_H\_debut\_der\ +\ 0.5*step\_num*d2H\_debut\_over\_H\_debut))\ <\ 1.0)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00257}00257\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00258}00258\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\ =\ continued\_fraction\_h\ (z\_aft,omega);\ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00259}00259\ \ \ \ \ \ \ std::complex<double>\ H\_debut\_not\_normed,dH\_debut\_not\_normed;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00260}00260\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00261}00261\ \ \ \ \ \ \ ODE\ (z\_aft,1.0,h,debut\_omega,H\_debut\_not\_normed,dH\_debut\_not\_normed);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00262}00262\ \ \ \ \ \ \ H\ =\ H\_debut/H\_debut\_not\_normed;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00263}00263\ \ \ \ \ \ \ dH\ =\ h*H;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00264}00264\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00265}00265\ \ \ \ \ \textcolor{keywordflow}{else}\ ODE\ (debut\_omega,H\_debut,dH\_debut,z\_aft,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00266}00266\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00267}00267\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (H)\ ||\ !\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (dH))\ std::cout<<\textcolor{stringliteral}{"{}Numerical\ failure\ encountered\ in\ H\_dH\_direct\_integration."{}}<<std::endl,exit\ (1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00269}00269\ \ \ \ \ debut\_omega\ =\ z\_aft,H\_debut\ =\ H,dH\_debut\ =\ dH;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00270}00270\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00271}00271\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00273}00273\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00274}00274\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00275}00275\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00276}00276\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00277}00277\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00279}00279\ \textcolor{comment}{//\ Calculation\ of\ H[omega](z),\ H'[omega](z)\ with\ the\ first\ order\ expansion\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00280}00280\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00281}00281\ \textcolor{comment}{//\ When\ imaginary\ parts\ of\ l,eta,z\ are\ much\ smaller\ than\ their\ real\ parts\ but\ not\ all\ zero,\ with\ Re[z]\ >\ 0,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00282}00282\ \textcolor{comment}{//\ one\ has\ to\ separate\ the\ calculation\ of\ the\ real\ and\ imaginary\ parts\ of\ H[omega]\ and\ H'[omega],\ as\ they\ can\ differ\ by\ tens\ of\ orders\ of\ magnitude.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00283}00283\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00284}00284\ \textcolor{comment}{//\ For\ that,\ one\ expands\ F(z),G(z),F'(z),G'(z)\ in\ first\ order\ in\ y,\ eta\_i\ and\ l\_i\ in\ first\_order\_expansions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00285}00285\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00286}00286\ \textcolor{comment}{//\ Then,\ H[omega](z)\ =\ G(z)\ +\ i.omega.norm.F(z)\ and\ H'[omega](z)\ =\ G'(z)\ +\ i.omega.norm.F'(z),}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00287}00287\ \textcolor{comment}{//\ with\ norm\ =\ 1\ if\ the\ wave\ functions\ are\ normalized\ and\ C(l,eta)\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00288}00288\ \textcolor{comment}{//\ One\ uses\ logs\ if\ norm\ underflows\ or\ overflows.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00289}00289\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00290}00290\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00291}00291\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00292}00292\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z),H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z),H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00293}00293\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00294}00294\ \textcolor{comment}{//\ H,dH\ :\ wave\ function\ H[omega]\ and\ derivative\ H'[omega]\ to\ calculate.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00295}00295\ \textcolor{comment}{//\ F,dF,G,dG\ :\ regular\ and\ irregular\ wave\ functions\ and\ derivatives\ in\ z,\ calculated\ with\ first\ order\ expansions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00296}00296\ \textcolor{comment}{//\ I\_omega\ :\ i.omega}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00297}00297\ \textcolor{comment}{//\ norm\_functions,log\_norm\ :\ 1\ if\ the\ wave\ functions\ are\ normalized\ and\ C(l,eta)\string^2\ if\ not,\ its\ log.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00298}00298\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00299}00299\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00300}00300\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::H\_dH\_from\_first\_order\_expansions\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H,std::complex<double>\ \&dH)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00301}00301\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00302}00302\ \ \ std::complex<double>\ F,dF,G,dG;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00303}00303\ \ \ first\_order\_expansions\ (\textcolor{keyword}{true},z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00304}00304\ \ \ first\_order\_expansions\ (\textcolor{keyword}{false},z,G,dG);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00305}00305\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00306}00306\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0,omega),norm\_functions\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (Cl\_eta*Cl\_eta)\ :\ (1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00307}00307\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00308}00308\ \ \ \textcolor{keywordflow}{if}\ ((norm\_functions\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (norm\_functions)))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00309}00309\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00310}00310\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_norm\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (2.0*log\_Cl\_eta)\ :\ (0.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00311}00311\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00312}00312\ \ \ \ \ H\ =\ G\ +\ I\_omega*exp\ (log\ (F)\ +\ log\_norm);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00313}00313\ \ \ \ \ dH\ =\ dG\ +\ I\_omega*exp\ (log\ (dF)\ +\ log\_norm);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00314}00314\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00315}00315\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00316}00316\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00317}00317\ \ \ \ \ H\ =\ G\ +\ I\_omega*norm\_functions*F;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00318}00318\ \ \ \ \ dH\ =\ dG\ +\ I\_omega*norm\_functions*dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00319}00319\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00320}00320\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00321}00321\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00322}00322\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00323}00323\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00324}00324\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00326}00326\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00327}00327\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00328}00328\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00329}00329\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00330}00330\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00331}00331\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00332}00332\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00333}00333\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00334}00334\ \textcolor{comment}{//\ Calculation\ of\ H(omega)\ and\ H(omega)'\ with\ F(z),\ F'(z)\ and\ continued\ fractions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00335}00335\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00336}00336\ \textcolor{comment}{//\ If\ 1+l-\/i.omega.eta\ is\ negative\ integer,\ one\ uses\ H[omega]\ =\ 1/F/(f\ -\/\ h[omega])\ as\ it\ is\ the\ only\ available\ solution}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00337}00337\ \textcolor{comment}{//\ linearly\ independent\ of\ F.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00338}00338\ \textcolor{comment}{//\ If\ 1+l+i.omega.eta\ is\ negative\ integer,\ H[omega]\ is\ proportional\ to\ F\ so\ the\ values\ F\ and\ F'\ are\ arbitrarily\ chosen\ for\ H[omega]\ and\ H'[omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00339}00339\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00340}00340\ \textcolor{comment}{//\ If\ not,\ one\ calculates\ h[sign(Im[z])](z),\ and\ one\ has\ f\ =\ F'(z)/F(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00341}00341\ \textcolor{comment}{//\ One\ chooses\ sign(Im[z]),\ as\ h\ converges\ fastest\ for\ z\ in\ this\ region.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00342}00342\ \textcolor{comment}{//\ If\ |f\ -\/\ h[sign(Im[z])]|oo\ >=\ 1,\ F\ and\ H[sign]\ are\ numerically\ linearly\ independent\ so\ the\ continued\ fraction\ is\ meaningful.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00343}00343\ \textcolor{comment}{//\ Then,\ h[-\/sign(Im[z])](z)\ is\ not\ needed\ and\ is\ put\ to\ f,\ the\ worst\ value\ it\ can\ have.\ If\ not,\ h[-\/sign(Im[z])](z)\ is\ needed\ and\ calculated.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00344}00344\ \textcolor{comment}{//\ Then,\ h[omega]\ and\ h[-\/omega]\ take\ their\ values\ from\ h[sign(Im[z])]|\ and\ h[-\/sign(Im[z])]|.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00345}00345\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00346}00346\ \textcolor{comment}{//\ If\ |f\ -\/\ h[omega]|oo\ >\ |f\ -\/\ h[-\/omega]|oo,\ one\ uses\ the\ continued\ fraction\ h[omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00347}00347\ \textcolor{comment}{//\ If\ Re[z]\ >\ 0\ or\ sign(Im[z])\ =\ omega\ (good\ quadrants),\ H[omega]\ =\ 1/F/(f\ -\/\ h[omega])\ and\ H'[omega]\ =\ h[omega].H[omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00348}00348\ \textcolor{comment}{//\ If\ not,\ one\ has\ to\ take\ the\ branch\ cut\ into\ account,\ as\ one\ is\ in\ the\ bad\ quadrant\ of\ H[omega]\ :\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00349}00349\ \textcolor{comment}{//\ H[omega]\ =\ 1/F/(f\ -\/\ h[omega])\ -\/\ cut\_constant.F\ and\ H'[omega]\ =\ h[omega].H[omega]\ -\/\ cut\_constant.F'\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00350}00350\ \textcolor{comment}{//\ cut\_constant\ is\ cut\_constant\_CFa\_plus\ if\ omega\ =\ 1,\ and\ cut\_constant\_CFa\_minus\ if\ omega\ =\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00351}00351\ \textcolor{comment}{//\ If\ log\ [cut\_constant]\ is\ not\ finite,\ it\ means\ that\ cut\_constant\ is\ exactly\ zero\ if\ it\ is\ defined,\ so\ that\ there\ is\ no\ branch\ cut\ to\ consider.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00352}00352\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00353}00353\ \textcolor{comment}{//\ If\ |f\ -\/\ h[omega]|oo\ <\ |f\ -\/\ h[-\/omega]|oo,\ one\ uses\ the\ continued\ fraction\ h[-\/omega],}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00354}00354\ \textcolor{comment}{//\ calculating\ H[omega]\ and\ H'[omega]\ using\ H[omega]\ =\ H[-\/omega]\ +\ constant.F\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00355}00355\ \textcolor{comment}{//\ constant\ is\ 2.i.omega.norm\ if\ Re[z]\ >\ 0\ or\ sign(Im[z])\ =\ -\/omega\ (good\ quadrants),\ and\ cut\_constant\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00356}00356\ \textcolor{comment}{//\ cut\_constant\ is\ cut\_constant\_CFb\_plus\ if\ omega\ =\ 1,\ cut\_constant\_CFb\_minus\ if\ omega\ =\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00357}00357\ \textcolor{comment}{//\ norm\ is\ 1\ if\ is\_it\_normalized\ is\ true,\ C(l,eta)\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00358}00358\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00359}00359\ \textcolor{comment}{//\ If\ cut\_constant\ underflows\ or\ overflows,\ one\ uses\ logs\ of\ F,F'\ and\ log\_cut\_constant\ for\ the\ calculation.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00360}00360\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00361}00361\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00362}00362\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00363}00363\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00364}00364\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00365}00365\ \textcolor{comment}{//\ F,dF:\ regular\ Coulomb\ wave\ function\ and\ derivative.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00366}00366\ \textcolor{comment}{//\ H,dH\ :\ H+(z)\ and\ H+'(z)\ if\ omega=1,\ H-\/(z)\ and\ H-\/'(z)\ if\ omega=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00367}00367\ \textcolor{comment}{//\ x,y\ :\ Re[z],\ Im[z].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00368}00368\ \textcolor{comment}{//\ f,two\_I\_omega\ :\ ratio\ F'(z)/F(z),\ 2.i.omega\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00369}00369\ \textcolor{comment}{//\ h\_sign,h\_minus\_sign\ :\ continuous\ fractions\ h[-\/SIGN[y]]\ and\ h[SIGN[y]].\ See\ before\ for\ their\ calculations}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00370}00370\ \textcolor{comment}{//\ h\_omega,h\_minus\_omega\ :\ continuous\ fraction\ h[omega]\ and\ h[-\/omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00371}00371\ \textcolor{comment}{//\ cut\_constant\_CFa,log\_cut\_constant\_CFa\ :\ cut\ constant\ for\ H[omega],\ so\ in\ its\ bad\ quadrant\ H[omega](z)\ =\ \ 1/F/(f\ -\/\ h[omega])\ -\/\ cut\_constant.F\ and\ its\ log.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00372}00372\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cut\_constant\ is\ cut\_constant\_CFa\_plus\ if\ omega\ =\ 1,\ cut\_constant\_CFa\_minus\ if\ omega\ =\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00373}00373\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ the\ log\ is\ not\ finite,\ cut\_constant\ has\ to\ be\ strictly\ zero\ if\ it\ is\ defined\ so\ there\ is\ no\ branch\ cut\ to\ consider.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00374}00374\ \textcolor{comment}{//\ H\_minus\_omega,dH\_minus\_omega\ :\ H-\/(z)\ and\ H-\/'(z)\ if\ omega=1,\ H+(z)\ and\ H+'(z)\ if\ omega=-\/1\ in\ good\ quadrants.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00375}00375\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ In\ bad\ quadrants,\ they\ are\ not\ equal\ to\ the\ previous\ functions,\ but\ combined\ with\ branch\ cut\ formulas,\ one\ calculates\ them.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00376}00376\ \textcolor{comment}{//\ cut\_constant\_CFb,constant,norm\_functions\ :\ cut\_constant\ is\ cut\_constant\_CFb\_plus\ if\ omega\ =\ 1,\ cut\_constant\_CFb\_minus\ if\ omega\ =\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00377}00377\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ constant\ is\ 2.i.omega.norm\_functions\ in\ good\ quadrants,\ cut\_constant\ in\ bad\ quadrants.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00378}00378\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ norm\_functions\ is\ 1\ for\ normalized\ functions,\ C(l,eta)\string^2\ for\ unnormalized\ wave\ functions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00379}00379\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ One\ has\ :\ H[-\/omega](z)\ =\ \ 1/F/(f\ -\/\ h[-\/omega])\ +\ constant.F\ in\ all\ quadrants.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00380}00380\ \textcolor{comment}{//\ log\_cut\_constant\_CFb,log\_constant,log\_norm\ :\ logs\ of\ previous\ values.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00381}00381\ \textcolor{comment}{//\ log\_two\_I\_omega\ :\ log[2.i.omega]\ =\ log[2]\ +\ i.omega.Pi/2\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00382}00382\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00383}00383\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::H\_dH\_with\_F\_dF\_and\_CF\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H,std::complex<double>\ \&dH)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00384}00384\ \{\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00385}00385\ \ \ std::complex<double>\ F,dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00386}00386\ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00387}00387\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00388}00388\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00389}00389\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ f\ =\ dF/F,two\_I\_omega(0.0,2.0*omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00390}00390\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00391}00391\ \ \ \textcolor{keywordflow}{if}\ (((neg\_int\_omega\_one\ \&\&\ (omega\ ==\ -\/1)))\ ||\ ((neg\_int\_omega\_minus\_one\ \&\&\ (omega\ ==\ 1))))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00392}00392\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00393}00393\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\_omega\ =\ continued\_fraction\_h\ (z,omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00394}00394\ \ \ \ \ H\ =\ 1.0/(F*(f\ -\/\ h\_omega)),dH\ =\ \ H*h\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00395}00395\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00396}00396\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (neg\_int\_omega\_one\ ||\ neg\_int\_omega\_minus\_one)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00397}00397\ \ \ \ \ H\ =\ F,dH\ =\ dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00398}00398\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00399}00399\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00400}00400\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\_sign\ =\ continued\_fraction\_h\ (z,\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y)),h\_minus\_sign\ =\ (abs\ (f\ -\/\ h\_sign)\ <\ 1.0)\ ?\ (continued\_fraction\_h\ (z,-\/\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y)))\ :\ (f);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00401}00401\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\_omega\ =\ (omega\ ==\ \mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y))\ ?\ (h\_sign)\ :\ (h\_minus\_sign),h\_minus\_omega\ =\ (omega\ ==\ \mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y))\ ?\ (h\_minus\_sign)\ :\ (h\_sign);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00402}00402\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00403}00403\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (f\ -\/\ h\_omega)\ >\ \mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (f\ -\/\ h\_minus\_omega))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00404}00404\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00405}00405\ \ \ \ \ \ \ H\ =\ 1.0/(F*(f\ -\/\ h\_omega)),dH\ =\ \ H*h\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00407}00407\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\_CFa\ =\ (omega\ ==\ 1)\ ?\ (log\_cut\_constant\_CFa\_plus)\ :\ (log\_cut\_constant\_CFa\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00408}00408\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00409}00409\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (log\_cut\_constant\_CFa))\ \&\&\ (x\ <\ 0.0)\ \&\&\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y)\ ==\ -\/omega))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00410}00410\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00411}00411\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ cut\_constant\_CFa\ =\ (omega\ ==\ 1)\ ?\ (cut\_constant\_CFa\_plus)\ :\ (cut\_constant\_CFa\_minus);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00412}00412\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00413}00413\ \ \ \ \ \textcolor{keywordflow}{if}\ ((cut\_constant\_CFa\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (cut\_constant\_CFa)))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00414}00414\ \ \ \ \ \ \ H\ -\/=\ exp\ (log\_cut\_constant\_CFa\ +\ log\ (F)),dH\ -\/=\ exp\ (log\_cut\_constant\_CFa\ +\ log\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00415}00415\ \ \ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00416}00416\ \ \ \ \ \ \ H\ -\/=\ cut\_constant\_CFa*F,dH\ -\/=\ cut\_constant\_CFa*dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00417}00417\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00418}00418\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00419}00419\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00420}00420\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00421}00421\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ H\_minus\_omega\ =\ 1.0/(F*(f\ -\/\ h\_minus\_omega)),dH\_minus\_omega\ =\ H\_minus\_omega*h\_minus\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00422}00422\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ norm\_functions\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (Cl\_eta*Cl\_eta)\ :\ (1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00423}00423\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ cut\_constant\_CFb\ =\ (omega\ ==\ 1)\ ?\ (cut\_constant\_CFb\_plus)\ :\ (cut\_constant\_CFb\_minus);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00424}00424\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ constant\ =\ ((x\ <\ 0.0)\ \&\&\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y)\ ==\ omega))\ ?\ (cut\_constant\_CFb)\ :\ (two\_I\_omega*norm\_functions);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00425}00425\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00426}00426\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((constant\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (constant)))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00427}00427\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00428}00428\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_norm\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (2.0*log\_Cl\_eta)\ :\ (0.0),log\_two\_I\_omega(M\_LN2,omega*M\_PI\_2);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00429}00429\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_cut\_constant\_CFb\ =\ (omega\ ==\ 1)\ ?\ (log\_cut\_constant\_CFb\_plus)\ :\ (log\_cut\_constant\_CFb\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00430}00430\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_constant\ =\ ((x\ <\ 0.0)\ \&\&\ (\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}\ (y)\ ==\ omega))\ ?\ (log\_cut\_constant\_CFb)\ :\ (log\_two\_I\_omega\ +\ log\_norm);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00431}00431\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00432}00432\ \ \ \ \ H\ =\ exp\ (log\_constant\ +\ log\ (F))\ +\ H\_minus\_omega,dH\ =\ exp\ (log\_constant\ +\ log\ (dF))\ +\ dH\_minus\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00433}00433\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00434}00434\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ H\ =\ constant*F\ +\ H\_minus\_omega,dH\ =\ constant*dF\ +\ dH\_minus\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00435}00435\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00436}00436\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00437}00437\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00438}00438\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00439}00439\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00440}00440\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00441}00441\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00442}00442\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00443}00443\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00444}00444\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00445}00445\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00446}00446\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00447}00447\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00448}00448\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00449}00449\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00450}00450\ \textcolor{comment}{//\ Calculation\ of\ H[omega],H'[omega]\ for\ std::complex\ l\ with\ the\ expansion\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00451}00451\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00452}00452\ \textcolor{comment}{//\ When\ 2l\ is\ non-\/integer,\ one\ can\ expand\ H[omega]\ with\ F[l,eta,z]\ and\ F[-\/l-\/1,eta,z].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00453}00453\ \textcolor{comment}{//\ H[omega]\ =\ (exp[i.omega.chi].F\ -\/\ Fp)/sin\ (chi),\ H'[omega]\ =\ (exp[i.omega.chi].F'\ -\/\ Fp')/sin\ (chi)\ if\ wave\ functions\ are\ normalized,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00454}00454\ \textcolor{comment}{//\ H[omega]\ =\ (exp[i.omega.chi].F.C(l,eta)\string^2/sin\ (chi)\ +\ Fp/(2l+1),\ H'[omega]\ =\ (exp[i.omega.chi].F'.C(l,eta)\string^2/sin\ (chi)\ +\ Fp'/(2l+1)\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00455}00455\ \textcolor{comment}{//\ chi\ is\ sigma(l,eta)\ -\/\ sigma(-\/l-\/1,eta)\ -\/\ (l+0.5).Pi,\ and\ Fp\ is\ F(-\/l-\/1,eta).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00456}00456\ \textcolor{comment}{//\ Fp\ is\ calculated\ using\ a\ class\ Coulomb\_wave\_functions\ with\ parameters\ -\/l-\/1\ and\ eta.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00457}00457\ \textcolor{comment}{//\ To\ avoid\ numerical\ imprecisions,\ sin\ (chi)\ is\ calculated\ with\ the\ stable\ formula\ -\/(2l+1).C(l,eta).C(-\/l-\/1,eta).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00458}00458\ \textcolor{comment}{//\ The\ validity\ of\ this\ expansion\ is\ checked\ with\ the\ wronskian\ of\ F\ and\ Fp,\ which\ must\ be\ correct\ up\ to\ precision\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00459}00459\ \textcolor{comment}{//\ F'.Fp\ -\/\ Fp'.F\ =\ sin\ (chi)\ if\ wave\ functions\ are\ normalized,\ Fp'.F\ -\/\ F'.Fp\ =\ 2l\ +\ 1\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00460}00460\ \textcolor{comment}{//\ If\ the\ wronskians\ are\ numerically\ correct,\ one\ does\ the\ calculation\ and\ is\_it\_successful\ is\ put\ to\ true.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00461}00461\ \textcolor{comment}{//\ If\ not,\ one\ puts\ is\_it\_successful\ to\ false\ and\ quits\ the\ routine.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00462}00462\ \textcolor{comment}{//\ If\ C(l,eta)\string^2\ underflows\ or\ overflows,\ one\ uses\ logs\ of\ F,F'\ and\ C(l,eta)\string^2\ for\ the\ calculation.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00463}00463\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00464}00464\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00465}00465\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00466}00466\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00467}00467\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00468}00468\ \textcolor{comment}{//\ F,dF:\ regular\ Coulomb\ wave\ function\ and\ derivative\ in\ l,eta\ and\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00469}00469\ \textcolor{comment}{//\ H,dH\ :\ H+(z)\ and\ H+'(z)\ if\ omega=1,\ H-\/(z)\ and\ H-\/'(z)\ if\ omega=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00470}00470\ \textcolor{comment}{//\ is\_it\_successful\ :\ false\ if\ the\ wronskian\ between\ F(l,eta,z)\ and\ F(-\/l-\/1,eta,z)\ is\ not\ equal\ to\ zero\ up\ to\ precision,\ true\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00471}00471\ \textcolor{comment}{//\ Fp,dFp\ :\ F(-\/l-\/1,eta,z),\ F'(-\/l-\/1,eta,z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00472}00472\ \textcolor{comment}{//\ exp\_I\_omega\_chi\ :\ exp[i.omega.chi]}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00473}00473\ \textcolor{comment}{//\ one\_over\_2lp1\ :\ 1/(2l\ +\ 1)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00474}00474\ \textcolor{comment}{//\ Cl\_eta\_2,exp\_I\_omega\_chi\_over\_sin\_chi\ :\ C(l,eta)\string^2,\ exp[i.omega.chi]/sin\ (chi)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00475}00475\ \textcolor{comment}{//\ F\_Cl\_eta\_2,\ dF\_Cl\_eta\_2\ :\ F(z).C(l,eta)\string^2,\ F'(z).C(l,eta)\string^2.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00476}00476\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00477}00477\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::H\_dH\_with\_expansion\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H,std::complex<double>\ \&dH,\textcolor{keywordtype}{bool}\ \&is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00478}00478\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00479}00479\ \ \ \textcolor{keywordflow}{if}\ (cwf\_lp\_ptr\ ==\ 0)\ cwf\_lp\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},-\/\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}-\/1,\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00481}00481\ \ \ std::complex<double>\ F,dF,Fp,dFp;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00482}00482\ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00483}00483\ \ \ cwf\_lp\_ptr-\/>\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,Fp,dFp);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00484}00484\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00485}00485\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ exp\_I\_omega\_chi\ =\ (omega\ ==\ 1)\ ?\ (exp\_I\_chi)\ :\ (exp\_minus\_I\_chi);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00486}00486\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00487}00487\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00488}00488\ \ \ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00489}00489\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ ((dFp*F\ -\/\ dF*Fp)*one\_over\_sin\_chi\ -\/\ 1.0)\ <\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00490}00490\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00491}00491\ \ \ \ \ \ \ H\ =\ (exp\_I\_omega\_chi*F\ -\/\ Fp)*one\_over\_sin\_chi;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00492}00492\ \ \ \ \ \ \ dH\ =\ (exp\_I\_omega\_chi*dF\ -\/\ dFp)*one\_over\_sin\_chi;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00493}00493\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00494}00494\ \ \ \ \ \textcolor{keywordflow}{else}\ \{is\_it\_successful\ =\ \textcolor{keyword}{false};\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00495}00495\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00496}00496\ \ \ \textcolor{keywordflow}{else}\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00497}00497\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00498}00498\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ one\_over\_2lp1\ =\ 1.0/(2*\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00499}00499\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00500}00500\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ ((dF*Fp\ -\/\ dFp*F)*one\_over\_2lp1\ -\/\ 1.0)\ <\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00501}00501\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00502}00502\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Cl\_eta\_2\ =\ Cl\_eta*Cl\_eta,exp\_I\_omega\_chi\_over\_sin\_chi\ =\ exp\_I\_omega\_chi*one\_over\_sin\_chi;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00503}00503\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ F\_Cl\_eta\_2\ =\ ((Cl\_eta\_2\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (Cl\_eta\_2)))\ ?\ (exp\ (2.0*log\_Cl\_eta\ +\ log\ (F)))\ :\ (Cl\_eta\_2*F);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00504}00504\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ dF\_Cl\_eta\_2\ =\ ((Cl\_eta\_2\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (Cl\_eta\_2)))\ ?\ (exp\ (2.0*log\_Cl\_eta\ +\ log\ (dF)))\ :\ (Cl\_eta\_2*dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00505}00505\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00506}00506\ \ \ \ \ \ \ H\ =\ exp\_I\_omega\_chi\_over\_sin\_chi*F\_Cl\_eta\_2\ +\ Fp*one\_over\_2lp1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00507}00507\ \ \ \ \ \ \ dH\ =\ exp\_I\_omega\_chi\_over\_sin\_chi*dF\_Cl\_eta\_2\ +\ dFp*one\_over\_2lp1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00508}00508\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00509}00509\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{is\_it\_successful\ =\ \textcolor{keyword}{false};\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00510}00510\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00511}00511\ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00512}00512\ \ \ is\_it\_successful\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00513}00513\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00514}00514\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00515}00515\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00516}00516\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00517}00517\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00518}00518\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00519}00519\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00520}00520\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00521}00521\ \textcolor{comment}{//\ Calculation\ of\ F\ and\ F'\ by\ power\ series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00522}00522\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00523}00523\ \textcolor{comment}{//\ It\ is\ used\ only\ when\ |z|\ <=\ 0.5,\ to\ avoid\ numerical\ inaccuracies.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00524}00524\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00525}00525\ \textcolor{comment}{//\ F(z)\ =\ norm.z\string^(l+1).\(\backslash\)sum\ a[n],\ n\ in\ [0:+oo[,\ where\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00526}00526\ \textcolor{comment}{//\ a[0]\ =\ 1.0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00527}00527\ \textcolor{comment}{//\ a[1]\ =\ z.eta/(l+1).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00528}00528\ \textcolor{comment}{//\ a[n]\ =\ (2.z.eta.a[n-\/1]\ -\/\ a[n-\/2].(z\string^2))/(n.(n+2l+1)),n\ >=\ 2.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00529}00529\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00530}00530\ \textcolor{comment}{//\ The\ z\ =\ 0\ case\ is\ treated\ first.\ It\ is\ defined\ only\ for\ Re[l]\ >\ 0\ or\ l\ =\ 0.\ The\ program\ aborts\ for\ other\ cases.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00531}00531\ \textcolor{comment}{//\ Norm\ is\ C(l,eta)\ if\ one\ uses\ normalized\ wave\ functions,\ 1.0\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00532}00532\ \textcolor{comment}{//\ So,\ one\ multiplies\ by\ C(l,eta)\ at\ the\ end\ if\ one\ uses\ normalized\ functions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00533}00533\ \textcolor{comment}{//\ If\ there\ is\ overflow\ or\ underflow\ for\ C(l,eta)\ in\ this\ last\ case,\ one\ uses\ logs\ of\ F,F'\ and\ C(l,eta)\ for\ the\ calculation.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00534}00534\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00535}00535\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00536}00536\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00537}00537\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00538}00538\ \textcolor{comment}{//\ F,dF\ :\ regular\ wave\ function\ and\ derivative}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00539}00539\ \textcolor{comment}{//\ z\_square,z\_two\_eta,z\_pow\_l\_plus\_one\ :\ z\string^2,\ 2.z.eta,\ z\string^\{l+1\}.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00540}00540\ \textcolor{comment}{//\ n\ :\ index\ of\ the\ power\ series\ term.\ It\ begins\ at\ two.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00541}00541\ \textcolor{comment}{//\ an,an\_minus\_one,an\_minus\_two\ :\ a[n],\ a[n-\/1],\ a[n-\/2].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00542}00542\ \textcolor{comment}{//\ The\ test\ of\ convergence\ is\ |(n+l-\/1).a[n-\/2]|oo\ +\ |(n+l).a[n-\/1]|oo,\ as\ one\ of\ the\ two\ can\ be\ zero\ even\ before\ convergence.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00543}00543\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00544}00544\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::F\_dF\_power\_series\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&F,std::complex<double>\ \&dF)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00545}00545\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00546}00546\ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0.0)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00547}00547\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00548}00548\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ ==\ 0)\ F\ =\ 0.0,dF\ =\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (Cl\_eta)\ :\ (1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00549}00549\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}})\ >\ 0)\ F\ =\ dF\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00550}00550\ \ \ \ \ \textcolor{keywordflow}{else}\ std::cout<<\textcolor{stringliteral}{"{}F(z=0)\ and/or\ F'(z=0)\ are\ undefined."{}}<<std::endl,\ abort\ ();}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00551}00551\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00552}00552\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00553}00553\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00554}00554\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_square\ =\ z*z,z\_two\_eta\ =\ 2.0*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00555}00555\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00556}00556\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ 2;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00557}00557\ \ \ \ \ std::complex<double>\ an\_minus\_two\ =\ 1.0,an\_minus\_one\ =\ z*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}/(\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00558}00558\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00559}00559\ \ \ \ \ F\ =\ an\_minus\_two\ +\ an\_minus\_one;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00560}00560\ \ \ \ \ dF\ =\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0)*an\_minus\_two\ +\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+2.0)*an\_minus\_one;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00561}00561\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00562}00562\ \ \ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (an\_minus\_two*(n+\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}-\/1.0))\ +\ \mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (an\_minus\_one*(n+\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}))\ >\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00563}00563\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00564}00564\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ an\ =\ (z\_two\_eta*an\_minus\_one\ -\/\ an\_minus\_two*z\_square)/(n*(n\ +\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 1.0));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00565}00565\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00566}00566\ \ \ \ \ \ \ F\ +=\ an;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00567}00567\ \ \ \ \ \ \ dF\ +=\ an*(n\ +\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00568}00568\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00569}00569\ \ \ \ \ \ \ n++;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00570}00570\ \ \ \ \ \ \ an\_minus\_two\ =\ an\_minus\_one;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00571}00571\ \ \ \ \ \ \ an\_minus\_one\ =\ an;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00572}00572\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00573}00573\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00574}00574\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_pow\_l\_plus\_one\ =\ pow\ (z,\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00575}00575\ \ \ \ \ F\ *=\ z\_pow\_l\_plus\_one;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00576}00576\ \ \ \ \ dF\ *=\ z\_pow\_l\_plus\_one/z;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00577}00577\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00578}00578\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00579}00579\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00580}00580\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((Cl\_eta\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (Cl\_eta)))\ F\ =\ exp\ (log\_Cl\_eta\ +\ log\ (F)),dF\ =\ exp\ (log\_Cl\_eta\ +\ log\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00581}00581\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ F\ *=\ Cl\_eta,dF\ *=\ Cl\_eta;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00582}00582\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00583}00583\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00584}00584\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00585}00585\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00586}00586\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00587}00587\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00588}00588\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00589}00589\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00590}00590\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00591}00591\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00592}00592\ \textcolor{comment}{//\ Calculation\ of\ f\ =\ F'/F\ with\ a\ continued\ fraction.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00593}00593\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00594}00594\ \textcolor{comment}{//\ One\ calculates\ the\ ratio\ f\ =\ F'/F\ with\ the\ continued\ fraction\ of\ the\ associated\ hypergeometric\ confluent\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00595}00595\ \textcolor{comment}{//\ One\ uses\ Lentz's\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00596}00596\ \textcolor{comment}{//\ One\ has\ :\ f\ =\ [b[0]\ +\ a[1]/b[1]+\ a[2]/b[2]+\ ...\ a[n]/b[n]+\ ...]/z\ with\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00597}00597\ \textcolor{comment}{//\ b[0]\ =\ l\ +\ 1\ +\ i.omega.z,\ a[n]\ =\ -\/2.i.omega.[1\ +\ l\ +\ i.omega.eta]\ +\ (n-\/1).[-\/2.i.omega.z],\ b[n]\ =\ 2l\ +\ 2\ +\ 2.i.omega.z\ +\ n-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00598}00598\ \textcolor{comment}{//\ omega\ is\ 1\ or\ -\/1,\ and\ theoretically\ the\ result\ is\ the\ same.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00599}00599\ \textcolor{comment}{//\ If\ they\ are\ not\ equal\ numerically,\ omega\ =\ sign[-\/Im\ [z]]\ gives\ usually\ the\ best\ result.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00600}00600\ \textcolor{comment}{//\ If\ 1+l+i.omega.eta\ is\ a\ negative\ integer,\ f[omega]\ is\ finite\ and\ must\ be\ used.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00601}00601\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00602}00602\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00603}00603\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00604}00604\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00605}00605\ \textcolor{comment}{//\ omega\ :\ 1\ or\ -\/1.\ Both\ values\ should\ be\ tried\ to\ test\ stability.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00606}00606\ \textcolor{comment}{//\ large,small\ :\ 1E50,1E-\/50.\ They\ are\ used\ in\ the\ case\ of\ vanishing\ denominators\ or\ numerators.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00607}00607\ \textcolor{comment}{//\ I\_omega,a,b\ :\ i.omega,\ 1\ +\ l\ +\ i.omega.eta,\ 2l\ +\ 2.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00608}00608\ \textcolor{comment}{//\ minus\_two\_I\_omega\_z,minus\_two\_I\_omega\_a\_z,b\_plus\_two\_I\_omega\_z\ :\ -\/2.i.omega.z,\ -\/2.i.omega.a.z,\ b\ +\ 2.i.omega.z}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00609}00609\ \textcolor{comment}{//\ b0,Cn,Dn,an,bn,Delta\_n\ :\ variables\ used\ in\ the\ Lentz\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00610}00610\ \textcolor{comment}{//\ n,nm1\ :\ index\ of\ a[n]\ and\ b[n],\ n-\/1\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00611}00611\ \textcolor{comment}{//\ bn\_plus\_an\_Dn\ :\ bn\ +\ an.Dn.\ Dn\ =\ 1/[bn\ +\ an.Dn]\ or\ large\ if\ bn\ +\ an.Dn\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00612}00612\ \textcolor{comment}{//\ bn\_plus\_an\_over\_Cn\ :\ bn\ +\ an/Cn.\ Cn\ =\ bn\ +\ an/Dn\ or\ small\ if\ bn\ +\ an/Dn\ is\ zero.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00613}00613\ \textcolor{comment}{//\ fn\ :\ value\ of\ the\ continuous\ fraction\ during\ the\ iteration\ process.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00614}00614\ \textcolor{comment}{//\ test\ :\ test\ of\ convergence\ of\ fn.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00615}00615\ \textcolor{comment}{//\ f\ :\ value\ of\ F'(z)/F(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00616}00616\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00617}00617\ std::complex<double>\ Coulomb\_wave\_functions::continued\_fraction\_f\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00618}00618\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00619}00619\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ small\ =\ 1E-\/50,large\ =\ 1E50;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00620}00620\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00621}00621\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0.0,omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00622}00622\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ a\ =\ I\_omega*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}\ +\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 1.0,b\ =\ 2*\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 2;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00623}00623\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ minus\_two\_I\_omega\_z\ =\ -\/2.0*I\_omega*z,minus\_two\_I\_omega\_a\_z\ =\ minus\_two\_I\_omega\_z*a,b\_plus\_two\_I\_omega\_z\ =\ b\ -\/\ minus\_two\_I\_omega\_z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00624}00624\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00625}00625\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ b0\ =\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}\ +\ 1.0\ +\ I\_omega*z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00626}00626\ \ \ std::complex<double>\ fn\ =\ (b0\ !=\ 0.0)\ ?\ (b0)\ :\ (small),\ Cn\ =\ fn,\ Dn\ =\ 0.0;\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00627}00627\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00628}00628\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00629}00629\ \ \ \textcolor{keywordtype}{double}\ test;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00630}00630\ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00631}00631\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00632}00632\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ nm1\ =\ n-\/1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00633}00633\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ an\ =\ minus\_two\_I\_omega\_a\_z\ +\ nm1*minus\_two\_I\_omega\_z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00634}00634\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ bn\ =\ b\_plus\_two\_I\_omega\_z\ +\ nm1;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00635}00635\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00636}00636\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ bn\_plus\_an\_Dn\ =\ bn\ +\ an*Dn,bn\_plus\_an\_over\_Cn\ =\ bn\ +\ an/Cn;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00637}00637\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00638}00638\ \ \ \ \ Dn\ =\ (bn\_plus\_an\_Dn\ !=\ 0.0)\ ?\ (1.0/bn\_plus\_an\_Dn)\ :\ (large);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00639}00639\ \ \ \ \ Cn\ =\ (bn\_plus\_an\_over\_Cn\ !=\ 0.0)\ ?\ (bn\_plus\_an\_over\_Cn)\ :\ (small);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00640}00640\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00641}00641\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Delta\_n\ =\ Dn*Cn;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00642}00642\ \ \ \ \ fn\ *=\ Delta\_n;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00643}00643\ \ \ \ \ test\ =\ \mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (1.0\ -\/\ Delta\_n);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00644}00644\ \ \ \ \ n++;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00645}00645\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00646}00646\ \ \ \textcolor{keywordflow}{while}\ (test\ >\ 1E-\/15);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00647}00647\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00648}00648\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ f\ =\ fn/z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00649}00649\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00650}00650\ \ \ \textcolor{keywordflow}{return}\ f;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00651}00651\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00652}00652\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00653}00653\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00654}00654\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00655}00655\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00656}00656\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00657}00657\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00658}00658\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00659}00659\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00660}00660\ \textcolor{comment}{//\ Calculation\ of\ F(z)\ and\ F'(z)\ with\ asymptotic\ series}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00661}00661\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00662}00662\ \textcolor{comment}{//\ F(z)\ =\ [H+(z)\ -\/\ H-\/(z)]/[2.i.norm].\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00663}00663\ \textcolor{comment}{//\ F'(z)\ =\ [H+'(z)\ -\/\ H-\/'(z)]/[2.i.norm].\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00664}00664\ \textcolor{comment}{//\ In\ this\ routine,\ Re[z]\ >=\ 0,\ so\ there\ is\ no\ branch\ cut\ problem.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00665}00665\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00666}00666\ \textcolor{comment}{//\ H+(z)\ =\ exp[i.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].S+(z)\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00667}00667\ \textcolor{comment}{//\ H-\/(z)\ =\ exp[-\/i.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].S-\/(z)\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00668}00668\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00669}00669\ \textcolor{comment}{//\ H+'(z)\ =\ exp[i.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].[S+'(z)\ +\ S+(z).i.(1\ -\/\ eta/z)]\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00670}00670\ \textcolor{comment}{//\ H-\/'(z)\ =\ exp[-\/i.[z\ -\/\ eta.log[2z]\ -\/\ l.Pi/2\ +\ sigma(l,eta)]].[S-\/'(z)\ -\/\ S-\/(z).i.(1\ -\/\ eta/z)]\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00671}00671\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00672}00672\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00673}00673\ \textcolor{comment}{//\ S+\ and\ S-\/\ and\ derivatives\ are\ calculated\ in\ asymptotic\_series.\ If\ is\_it\_successful\ is\ true,\ the\ series\ are\ meaningful.\ If\ not,\ one\ leaves\ the\ routine.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00674}00674\ \textcolor{comment}{//\ Norm\ is\ C(l,eta)\ if\ one\ uses\ normalized\ wave\ functions,\ 1.0\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00675}00675\ \textcolor{comment}{//\ If\ there\ is\ overflow\ or\ underflow\ for\ C(l,eta)\ in\ this\ last\ case,\ one\ uses\ logs\ of\ F,F'\ and\ C(l,eta)\ for\ the\ calculation.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00676}00676\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00677}00677\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00678}00678\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00679}00679\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00680}00680\ \textcolor{comment}{//\ one\_over\_z\ :\ 1/z}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00681}00681\ \textcolor{comment}{//\ F,dF\ :\ regular\ wave\ function\ and\ derivative\ to\ calculate.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00682}00682\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ calculation\ converged,\ i.e.\ the\ series\ are\ good\ up\ to\ precision\ and\ the\ wronskian\ of\ H+,H-\/\ up\ to\ precision,\ false\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00683}00683\ \textcolor{comment}{//\ sum,dsum\ :\ asymptotic\ series.\ sum[0]\ =\ S+(z),\ sum[1]\ =\ S-\/(z),\ dsum[0]\ =\ S+'(z),\ dsum[1]\ =\ S-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00684}00684\ \textcolor{comment}{//\ I,one\_over\_two\_I\ :\ i,1/[2i].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00685}00685\ \textcolor{comment}{//\ I\_one\_minus\_eta\_over\_z\ :\ i*(1\ -\/\ eta/z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00686}00686\ \textcolor{comment}{//\ exp\_phase\_shift\_plus\ :\ exp\ (i*(z\ -\/\ eta.log(2z)\ -\/\ l.Pi/2\ +\ sigma(l,eta)))).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00687}00687\ \textcolor{comment}{//\ exp\_phase\_shift\_minus\ :\ exp\ (-\/i*(z\ -\/\ eta.log(2z)\ -\/\ l.Pi/2\ +\ sigma(l,eta)))).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00688}00688\ \textcolor{comment}{//\ H\_plus,dH\_plus,H\_minus,dH\_minus\ :\ exp\ (+/-\/i*(z\ -\/\ eta.log(2z)\ -\/\ l.Pi/2\ +\ sigma(l,eta))).S(+/-\/)(z)\ and\ derivatives.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00689}00689\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00690}00690\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::asymptotic\_expansion\_F\_dF\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&F,std::complex<double>\ \&dF,\textcolor{keywordtype}{bool}\ \&is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00691}00691\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00692}00692\ \ \ std::complex<double>\ sum[2],dsum[2];}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00693}00693\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00694}00694\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ one\_over\_z\ =\ 1.0/z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00695}00695\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00696}00696\ \ \ asymptotic\_series\ (1,one\_over\_z,sum,dsum,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00697}00697\ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00698}00698\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00699}00699\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I(0,1),one\_over\_two\_I(0.0,-\/0.5),I\_one\_minus\_eta\_over\_z\ =\ I*(1.0\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*one\_over\_z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00700}00700\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00701}00701\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ exp\_phase\_shift\_plus\ =\ exp\ (I*(z\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*(M\_LN2\ +\ log\ (z))\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}*M\_PI\_2\ +\ sigma\_l));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00702}00702\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ exp\_phase\_shift\_minus\ =\ 1.0/exp\_phase\_shift\_plus;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00703}00703\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00704}00704\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ H\_plus\ =\ sum[0]*exp\_phase\_shift\_plus,dH\_plus\ =\ (dsum[0]\ +\ sum[0]*I\_one\_minus\_eta\_over\_z)*exp\_phase\_shift\_plus;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00705}00705\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ H\_minus\ =\ sum[1]*exp\_phase\_shift\_minus,dH\_minus\ =\ (dsum[1]\ -\/\ sum[1]*I\_one\_minus\_eta\_over\_z)*exp\_phase\_shift\_minus;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00706}00706\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00707}00707\ \ \ F\ =\ (H\_plus\ -\/\ H\_minus)*one\_over\_two\_I;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00708}00708\ \ \ dF\ =\ (dH\_plus\ -\/\ dH\_minus)*one\_over\_two\_I;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00709}00709\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00710}00710\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00711}00711\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00712}00712\ \ \ \ \ \textcolor{keywordflow}{if}\ ((Cl\_eta\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (Cl\_eta)))\ F\ =\ exp\ (log\ (F)\ -\/\ log\_Cl\_eta),dF\ =\ exp\ (log\ (dF)\ -\/\ log\_Cl\_eta);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00713}00713\ \ \ \ \ \textcolor{keywordflow}{else}\ F\ /=\ Cl\_eta,dF\ /=\ Cl\_eta;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00714}00714\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00715}00715\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00716}00716\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00717}00717\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00718}00718\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00719}00719\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00720}00720\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00721}00721\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00722}00722\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00723}00723\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00724}00724\ \textcolor{comment}{//\ Calculation\ of\ F(z)\ and\ F'(z)\ by\ direct\ integration.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00725}00725\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00726}00726\ \textcolor{comment}{//\ To\ calculate\ F(z)\ and\ F'(z),\ one\ integrates\ numerically\ F''(z)\ =\ [l(l+1)/z\string^2\ +\ 2.eta/z\ -\/\ 1].F(z)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00727}00727\ \textcolor{comment}{//\ starting\ from\ debut,\ F\_debut\ =\ F(debut)\ and\ dF\_debut\ =\ F'(debut).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00728}00728\ \textcolor{comment}{//\ One\ always\ has\ Re[z]\ >=\ 0.0,\ so\ there\ is\ no\ branch\ cut\ problem.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00729}00729\ \textcolor{comment}{//\ If\ z\ =\ debut,\ the\ previous\ values\ are\ returned.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00730}00730\ \textcolor{comment}{//\ The\ starting\ point\ come\ from\ the\ stored\ values\ debut,\ F\_debut\ and\ dF\_debut.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00731}00731\ \textcolor{comment}{//\ If\ debut\ =\ 0,\ one\ puts\ debut\ =\ z/|2z|\ and\ calculates\ F(debut)\ and\ F'(debut)\ with\ power\ series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00732}00732\ \textcolor{comment}{//\ The\ step\ of\ the\ integration\ is\ (z\ -\/\ debut)/N\_num,\ with\ N\_num\ =\ [|z\ -\/\ debut|/min\ (0.1,10.turning\_point)]\ +\ 1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00733}00733\ \textcolor{comment}{//\ The\ value\ of\ min\ (0.1,10/turning\_point)\ gives\ a\ smaller\ step\ when\ turning\_point\ increases,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00734}00734\ \textcolor{comment}{//\ as\ calculations\ become\ there\ more\ difficult\ as\ |F|\ typically\ varies\ faster\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00735}00735\ \textcolor{comment}{//\ The\ intermediates\ points\ are\ called\ z\_aft.\ They\ go\ from\ debut\ to\ z,\ and\ (debut,F\_debut,dF\_debut)\ is\ put\ to\ \{z\_aft,F(z\_aft),F'(z\_aft)\}\ at\ each\ step.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00736}00736\ \textcolor{comment}{//\ If\ |F|\ increases\ along\ the\ path,\ the\ integration\ is\ stable.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00737}00737\ \textcolor{comment}{//\ If\ it\ decreases,\ and\ if\ z\_aft\ decreases\ in\ modulus\ or\ one\ does\ not\ integrate\ with\ constant\ argument\ (i.e.\ theta\ constant\ in\ z\ =\ |z|.exp[i.theta])\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00738}00738\ \textcolor{comment}{//\ for\ Re[l]\ >\ -\/1,\ one\ reintegrates\ F(z)\ from\ debut\ =\ z/|2z|,\ as\ integration\ is\ usually\ stable\ at\ constant\ argument\ for\ Re[l]\ >\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00739}00739\ \textcolor{comment}{//\ Increase\ or\ decrease\ is\ known\ using\ the\ Taylor\ expansion\ of\ F\ near\ debut\ in\ z\ up\ to\ second\ order.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00740}00740\ \textcolor{comment}{//\ If\ one\ integrates\ with\ constant\ argument\ and\ |F|\ decreases,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00741}00741\ \textcolor{comment}{//\ one\ integrates\ backwards\ from\ z\_aft\ to\ debut\ with\ the\ knowledge\ of\ f(z\_aft)\ =\ F'(z\_aft)/F(z\_aft).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00742}00742\ \textcolor{comment}{//\ F'(z\_aft)/F(z\_aft)\ is\ given\ by\ the\ continued\ fraction\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00743}00743\ \textcolor{comment}{//\ One\ then\ obtains\ by\ direct\ integration\ C.F(debut)\ and\ C.F'(debut).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00744}00744\ \textcolor{comment}{//\ Knowing\ F\_debut,\ one\ deduces\ F(z)\ =\ 1/C\ and\ F'(z)\ =\ f(z\_aft).F(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00745}00745\ \textcolor{comment}{//\ If\ 1+l+i.omega.eta\ is\ a\ negative\ integer,\ f[omega]\ is\ finite\ and\ is\ used.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00746}00746\ \textcolor{comment}{//\ Otherwise,\ f(z\_aft)\ is\ calculated\ with\ omega\ =\ 1\ and\ -\/1.\ If\ they\ are\ equal\ up\ to\ precision,\ f(omega)\ is\ correct\ and\ used.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00747}00747\ \textcolor{comment}{//\ omega\ is\ chosen\ so\ Re[-\/2.i.omega.z]\ <\ 0,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00748}00748\ \textcolor{comment}{//\ for\ which\ the\ anomalous\ convergence\ phenomenon\ of\ Gautschi\ of\ f\ is\ the\ smallest\ (W.\ Gautschi,\ Math.\ Comp.\ Vol.\ 31\ p.994).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00749}00749\ \textcolor{comment}{//\ If\ not,\ but\ |norm.F|\ <\ 0.1,\ one\ still\ has\ to\ use\ f[omega],\ as\ it\ is\ probably\ correct\ as\ F\ is\ the\ minimal\ solution,\ and\ also\ one\ has\ no\ other\ way\ to\ calculate\ F.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00750}00750\ \textcolor{comment}{//\ If\ |norm.F|\ >\ 0.1\ in\ this\ case,\ one\ stops\ the\ procedure\ and\ F\ will\ be\ calculated\ from\ H+\ and\ H-\/,\ given\ by\ direct\ integration\ and\ continued\ fraction\ formulae.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00751}00751\ \textcolor{comment}{//\ In\ this\ case,\ is\_it\_successful\ is\ put\ to\ false,\ and\ otherwise\ the\ integration\ worked\ and\ it\ is\ put\ to\ true.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00752}00752\ \textcolor{comment}{//\ Norm\ is\ 1.0\ if\ one\ uses\ normalized\ wave\ functions,\ C(l,eta)\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00753}00753\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00754}00754\ \textcolor{comment}{//\ If\ F(z\_aft)\ is\ not\ finite,\ one\ stops\ the\ integration\ and\ is\_it\_successful\ is\ put\ to\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00755}00755\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00756}00756\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00757}00757\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00758}00758\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00759}00759\ \textcolor{comment}{//\ F,dF\ :\ regular\ wave\ function\ and\ derivative\ to\ calculate.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00760}00760\ \textcolor{comment}{//\ is\_it\_successful\ :\ false\ is\ the\ calculation\ is\ unstable,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00761}00761\ \textcolor{comment}{//\ i.e.\ |F|\ >\ 0.1\ decreasing\ on\ the\ integration\ path\ and\ f(omega)\ is\ not\ equal\ to\ f(-\/omega)\ up\ to\ precision,\ true\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00762}00762\ \textcolor{comment}{//\ ODE\ :\ reference\ to\ pointer\ ODE\_ptr,\ which\ performs\ direct\ integration\ from\ one\ point\ to\ another.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00763}00763\ \textcolor{comment}{//\ step\_abs\ :\ length\ of\ the\ integration\ step\ from\ z\ to\ debut.\ It\ is\ min\ (0.1,10/turning\_point)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00764}00764\ \textcolor{comment}{//\ N\_num\ :\ number\ of\ integrations\ to\ do\ from\ debut\ to\ z.\ It\ is\ |z\ -\/\ debut|/step\_abs\ +\ 1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00765}00765\ \textcolor{comment}{//\ step\_num\ :\ std::complex\ step\ from\ debut\ to\ z.\ It\ is\ (z\ -\/\ debut)/N\_num\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00766}00766\ \textcolor{comment}{//\ ll\_plus\_one,two\_eta\ :\ l(l+1),\ 2.eta.\ They\ are\ used\ in\ the\ Taylor\ expansion\ test.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00767}00767\ \textcolor{comment}{//\ z\_aft\ :\ next\ point\ in\ which\ F\ is\ calculated\ by\ direct\ integration\ .\ It\ is\ z\ -\/\ i*step\_num,\ with\ i\ from\ N\_num-\/1\ to\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00768}00768\ \textcolor{comment}{//\ one\_over\_debut,log\_F\_debut\_der,d2F\_debut\_over\_F\_debut:\ 1/debut,\ F'(debut)/F(debut),\ F''(debut)/F(debut).\ They\ are\ used\ in\ the\ Taylor\ expansion\ test.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00769}00769\ \textcolor{comment}{//\ ratio\ :\ debut/z.\ It\ is\ used\ to\ know\ if\ one\ integrates\ with\ constant\ argument\ or\ if\ |z\_aft|\ increases.\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00770}00770\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ If\ not\ and\ |F|\ increases\ and\ Re[l]\ >\ -\/1,\ one\ reintegrates\ from\ z/|2z|.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00771}00771\ \textcolor{comment}{//\ f\_omega,f\_minus\_omega\ :\ continued\ fractions\ F'/F\ with\ omega\ =\ sign(-\/Im[z\_aft])\ and\ -\/omega.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00772}00772\ \textcolor{comment}{//\ fp,fm\ :\ continued\ fractions\ F'/F\ with\ omega\ =\ 1\ or\ -\/1\ used\ in\ the\ case\ of\ 1+l\ +/-\/\ i.eta\ negative\ integer,\ as\ continued\ fractions\ are\ finite\ in\ this\ case.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00773}00773\ \textcolor{comment}{//\ norm\_functions\ :\ C(l,eta)\string^2\ for\ unnormalized\ functions,\ 1\ for\ normalized\ functions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00774}00774\ \textcolor{comment}{//\ F\_debut\_not\_normed,dF\_debut\_not\_normed\ :\ unnormed\ regular\ wave\ function\ and\ derivative\ in\ debut,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00775}00775\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ after\ integration\ from\ the\ starting\ point\ \{z\_aft,\ 1.0,\ F'(z\_aft)/F(z\_aft)\}.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00776}00776\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Then,\ F(z\_aft)\ =\ \ F\_debut/F\_debut\_not\_normed\ and\ F'(z\_aft)\ =\ f[omega].F\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00777}00777\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00778}00778\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::F\_dF\_direct\_integration\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&F,std::complex<double>\ \&dF,\textcolor{keywordtype}{bool}\ \&is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00779}00779\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00780}00780\ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ debut)\ \{F\ =\ F\_debut,dF\ =\ dF\_debut,is\_it\_successful\ =\ \textcolor{keyword}{true};\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00781}00781\ \ \ \textcolor{keywordflow}{if}\ (debut\ ==\ 0.0)\ debut\ =\ 0.5*z/abs\ (z),F\_dF\_power\_series\ (debut,F\_debut,dF\_debut);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00782}00782\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00783}00783\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_o_d_e__integration}{ODE\_integration}}\ \&ODE\ =\ *ODE\_ptr;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00784}00784\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ step\_abs\ =\ std::min(0.1,10.0/turning\_point);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00785}00785\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ N\_num\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\textcolor{keyword}{>}\ (rint\ (abs\ (z-\/debut)/step\_abs)\ +\ 1);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00786}00786\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ step\_num\ =\ (z\ -\/\ debut)/\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}\ (N\_num),ll\_plus\_one\ =\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}*(\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0),two\_eta\ =\ 2.0*\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00787}00787\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ norm\_functions\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (Cl\_eta*Cl\_eta)\ :\ (1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00788}00788\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00789}00789\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ N\_num-\/1\ ;\ i\ <=\ N\_num\ ;\ i-\/-\/)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00790}00790\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00791}00791\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ z\_aft\ =\ z\ -\/\ i*step\_num,one\_over\_debut\ =\ 1.0/debut,log\_F\_debut\_der\ =\ dF\_debut/F\_debut;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00792}00792\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ d2F\_debut\_over\_F\_debut\ =\ (ll\_plus\_one*one\_over\_debut\ +\ two\_eta)*one\_over\_debut\ -\/\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00793}00793\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00794}00794\ \ \ \ \ \textcolor{keywordflow}{if}\ (abs\ (1.0\ +\ step\_num*(log\_F\_debut\_der\ +\ 0.5*step\_num*d2F\_debut\_over\_F\_debut))\ <\ 1.0)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00795}00795\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00796}00796\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ ratio\ =\ debut/z;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00797}00797\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}})\ >\ -\/1.0)\ \&\&\ ((std::abs\ (imag\ (ratio))\ >\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}})\ ||\ (real\ (ratio)\ >\ 1.0)))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00798}00798\ \ \ \ \ \{debut\ =\ 0.0,\ F\_dF\_direct\_integration\ (z,F,dF,is\_it\_successful);\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00799}00799\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00800}00800\ \ \ \ \ \ \ std::complex<double>\ F\_debut\_not\_normed,dF\_debut\_not\_normed;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00801}00801\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00802}00802\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (neg\_int\_omega\_one)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00803}00803\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00804}00804\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ fp\ =\ continued\_fraction\_f\ (z\_aft,1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00805}00805\ \ \ \ \ ODE\ (z\_aft,1.0,fp,debut,F\_debut\_not\_normed,dF\_debut\_not\_normed);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00806}00806\ \ \ \ \ F\ =\ F\_debut/F\_debut\_not\_normed;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00807}00807\ \ \ \ \ dF\ =\ fp*F;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00808}00808\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00809}00809\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (neg\_int\_omega\_minus\_one)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00810}00810\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00811}00811\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ fm\ =\ continued\_fraction\_f\ (z\_aft,-\/1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00812}00812\ \ \ \ \ ODE\ (z\_aft,1.0,fm,debut,F\_debut\_not\_normed,dF\_debut\_not\_normed);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00813}00813\ \ \ \ \ F\ =\ F\_debut/F\_debut\_not\_normed;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00814}00814\ \ \ \ \ dF\ =\ fm*F;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00815}00815\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00816}00816\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00817}00817\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00818}00818\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ f\_omega\ =\ continued\_fraction\_f\ (z\_aft,\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}(-\/imag(z\_aft))),f\_minus\_omega\ =\ continued\_fraction\_f\ (z\_aft,-\/\mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}(-\/imag(z\_aft)));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00819}00819\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00821}00821\ \ \ \ \ \textcolor{keywordflow}{if}\ ((abs\ (F*norm\_functions)\ >\ 0.1)\ \&\&\ (abs\ (f\_minus\_omega/f\_omega\ -\/\ 1.0)\ >\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}}))\ \{is\_it\_successful\ =\ \textcolor{keyword}{false};\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00822}00822\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00823}00823\ \ \ \ \ ODE\ (z\_aft,1.0,f\_omega,debut,F\_debut\_not\_normed,dF\_debut\_not\_normed);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00824}00824\ \ \ \ \ F\ =\ F\_debut/F\_debut\_not\_normed;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00825}00825\ \ \ \ \ dF\ =\ f\_omega*F;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00826}00826\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00827}00827\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00828}00828\ \ \ \ \ \textcolor{keywordflow}{else}\ ODE\ (debut,F\_debut,dF\_debut,z\_aft,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00829}00829\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00830}00830\ \ \ \ \ debut\ =\ z\_aft,F\_debut\ =\ F,dF\_debut\ =\ dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00831}00831\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00832}00832\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (F)\ ||\ !\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (dF))\ std::cout<<\textcolor{stringliteral}{"{}Numerical\ failure\ encountered\ in\ F\_dF\_direct\_integration."{}}<<std::endl,exit\ (1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00833}00833\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00834}00834\ \ \ is\_it\_successful\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00835}00835\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00836}00836\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00837}00837\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00838}00838\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00839}00839\ \textcolor{comment}{//\ Regular\ wave\ function\ and\ derivative\ from\ symmetry\ relations.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00840}00840\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00841}00841\ \textcolor{comment}{//\ If\ |z|\ >\ 0.5\ and\ Re[z]\ <\ 0,\ one\ calculates\ F(l,eta,z),F'(l,eta,z)\ from\ F(l,-\/eta,-\/z),F'(l,-\/eta,-\/z)\ using\ the\ formulas\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00842}00842\ \textcolor{comment}{//\ F(l,eta,z)\ =\ -\/F(l,-\/eta,-\/z).exp[-\/Pi.(eta-\/i.l)],\ F'(l,eta,z)\ =\ F'(l,-\/eta,-\/z).exp[-\/Pi.(eta-\/i.l)]\ if\ arg\ (z)\ >\ 0\ and\ is\_it\_normalized\ is\ true,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00843}00843\ \textcolor{comment}{//\ F(l,eta,z)\ =\ -\/F(l,-\/eta,-\/z).exp[-\/Pi.(eta+i.l)],\ F'(l,eta,z)\ =\ F'(l,-\/eta,-\/z).exp[-\/Pi.(eta+i.l)]\ if\ arg\ (z)\ <=\ 0\ and\ is\_it\_normalized\ is\ true,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00844}00844\ \textcolor{comment}{//\ F(l,eta,z)\ =\ -\/F(l,-\/eta,-\/z).exp[i.Pi.l)],\ F'(l,eta,z)\ =\ F'(l,-\/eta,-\/z).exp[i.Pi.l)]\ if\ arg\ (z)\ >\ 0\ and\ is\_it\_normalized\ is\ false,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00845}00845\ \textcolor{comment}{//\ F(l,eta,z)\ =\ -\/F(l,-\/eta,-\/z).exp[-\/i.Pi.l)],\ F'(l,eta,z)\ =\ F'(l,-\/eta,-\/z).exp[-\/i.Pi.l)]\ if\ arg\ (z)\ <=\ 0\ and\ is\_it\_normalized\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00846}00846\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00847}00847\ \textcolor{comment}{//\ F(l,-\/eta,-\/z)\ is\ calculated\ using\ the\ class\ cwf\_minus\_eta\_ptr\ defined\ with\ (l,-\/eta).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00848}00848\ \textcolor{comment}{//\ The\ debut\ point\ of\ the\ class\ cwf\_minus\_eta\_ptr\ is\ initialized\ with\ \{debut,F\_debut,dF\_debut\}\ and\ previous\ relations}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00849}00849\ \textcolor{comment}{//\ if\ cwf\_minus\_eta\_ptr-\/>debut\ and\ -\/debut\ are\ different\ and\ debut\ non\ zero.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00850}00850\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00851}00851\ \textcolor{comment}{//\ If\ the\ normalization\ constant\ underflows\ or\ overflows,\ one\ uses\ logs.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00852}00852\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00853}00853\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00854}00854\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00855}00855\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00856}00856\ \textcolor{comment}{//\ F,dF\ :\ regular\ wave\ function\ and\ derivative\ to\ calculate.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00857}00857\ \textcolor{comment}{//\ arg\_debut,\ arg\_z\ :\ argument\ angles\ of\ debut\ and\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00858}00858\ \textcolor{comment}{//\ sym\_constant\_debut,log\_sym\_constant\_debut\ :\ constant\ C\ so\ F(l,-\/eta,-\/debut)\ =\ C.F(l,eta,debut),\ its\ log.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00859}00859\ \textcolor{comment}{//\ sym\_constant,log\_sym\_constant\ :\ constant\ C\ so\ F(l,eta,z)\ =\ C.F(l,-\/eta,-\/z),\ its\ log.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00860}00860\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00861}00861\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::F\_dF\_with\_symmetry\_relations\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&F,std::complex<double>\ \&dF)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00862}00862\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00863}00863\ \ \ \textcolor{keywordflow}{if}\ (cwf\_minus\_eta\_ptr\ ==\ 0)\ cwf\_minus\_eta\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}},-\/\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00864}00864\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00865}00865\ \ \ \textcolor{keywordflow}{if}\ ((debut\ !=\ 0.0)\ \&\&\ (cwf\_minus\_eta\_ptr-\/>debut\ !=\ -\/debut))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00866}00866\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00867}00867\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ arg\_debut\ =\ arg\ (debut);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00868}00868\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sym\_constant\_debut\ =\ (arg\_debut\ <=\ 0.0)\ ?\ (1.0/sym\_constant\_arg\_neg)\ :\ (1.0/sym\_constant\_arg\_pos);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00869}00869\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00870}00870\ \ \ \ \ cwf\_minus\_eta\_ptr-\/>debut\ =\ -\/debut;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00871}00871\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00872}00872\ \ \ \ \ \textcolor{keywordflow}{if}\ ((sym\_constant\_debut\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (sym\_constant\_debut)))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00873}00873\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00874}00874\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_sym\_constant\_debut\ =\ (arg\ (debut)\ <=\ 0.0)\ ?\ (-\/log\_sym\_constant\_arg\_neg)\ :\ (-\/log\_sym\_constant\_arg\_pos);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00875}00875\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00876}00876\ \ \ \ \ \ \ cwf\_minus\_eta\_ptr-\/>F\_debut\ =\ exp\ (log\_sym\_constant\_debut\ +\ log\ (F\_debut));\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00877}00877\ \ \ \ \ \ \ cwf\_minus\_eta\_ptr-\/>dF\_debut\ =\ -\/exp\ (log\_sym\_constant\_debut\ +\ log\ (dF\_debut));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00878}00878\ \ \ \ \ \}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00879}00879\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00880}00880\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00881}00881\ \ \ \ \ \ \ cwf\_minus\_eta\_ptr-\/>F\_debut\ =\ F\_debut*sym\_constant\_debut;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00882}00882\ \ \ \ \ \ \ cwf\_minus\_eta\_ptr-\/>dF\_debut\ =\ -\/dF\_debut*sym\_constant\_debut;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00883}00883\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00884}00884\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00885}00885\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00886}00886\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ arg\_z\ =\ arg\ (z);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00887}00887\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sym\_constant\ =\ (arg\_z\ <=\ 0.0)\ ?\ (sym\_constant\_arg\_neg)\ :\ (sym\_constant\_arg\_pos);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00888}00888\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00889}00889\ \ \ cwf\_minus\_eta\_ptr-\/>\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (-\/z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00890}00890\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00891}00891\ \ \ \textcolor{keywordflow}{if}\ ((sym\_constant\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (sym\_constant)))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00892}00892\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00893}00893\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ log\_sym\_constant\ =\ (arg\_z\ <=\ 0.0)\ ?\ (log\_sym\_constant\_arg\_neg)\ :\ (log\_sym\_constant\_arg\_pos);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00894}00894\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00895}00895\ \ \ \ \ F\ =\ exp\ (log\_sym\_constant\ +\ log\ (F));\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00896}00896\ \ \ \ \ dF\ =\ -\/exp\ (log\_sym\_constant\ +\ log\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00897}00897\ \ \ \}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00898}00898\ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00899}00899\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00900}00900\ \ \ \ \ F\ *=\ sym\_constant;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00901}00901\ \ \ \ \ dF\ *=\ -\/sym\_constant;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00902}00902\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00903}00903\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00904}00904\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00905}00905\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00906}00906\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00907}00907\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00908}00908\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00909}00909\ \textcolor{comment}{//\ Calculation\ of\ the\ asymptotic\ series}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00910}00910\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00911}00911\ \textcolor{comment}{//\ Asymptotic\ expansion:\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00912}00912\ \textcolor{comment}{//\ S(+/-\/)(z)\ =\ 1.0+\(\backslash\)sum\_(n=1)\string^N\ a[n]\ with\ a[n+1]=a[n].[n.[n+1+/-\/2i.eta]+i.eta.(i.eta+/-\/1)-\/l(l+1)]/[+/-\/2i.(n+1)]/z,\ n\ >=\ 0\ and\ a[0]\ =\ 1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00913}00913\ \textcolor{comment}{//\ This\ expansion\ diverges\ :\ it\ is\ only\ useful\ with\ the\ smallest\ term\ summation\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00914}00914\ \textcolor{comment}{//\ The\ test\ of\ convergence\ is\ max(|a[n]|oo,|n.a[n]/z|oo),\ so\ the\ largest\ norm\ of\ the\ term\ of\ series\ of\ function\ and\ derivative.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00915}00915\ \textcolor{comment}{//\ Practically,\ one\ stops\ when\ test\ <\ precision\ (it\ worked)\ or\ when\ test\ is\ not\ finite\ (it\ failed).\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00916}00916\ \textcolor{comment}{//\ After\ that,\ one\ tests\ the\ series\ with\ the\ wronskian\ of\ H[omega]\ and\ H[-\/omega].\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00917}00917\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00918}00918\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00919}00919\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00920}00920\ \textcolor{comment}{//\ z\ is\ the\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00921}00921\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00922}00922\ \textcolor{comment}{//\ one\_over\_z\ :\ 1/z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00923}00923\ \textcolor{comment}{//\ sum\ :\ sum[0]\ is\ the\ series\ in\ H(omega),\ sum[1]\ the\ one\ in\ H(-\/omega).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00924}00924\ \textcolor{comment}{//\ dsum\ :\ dsum[0]\ is\ the\ series\ in\ H'(omega),\ dsum[1]\ the\ one\ in\ H'(-\/omega).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00925}00925\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ series\ converged\ and\ |wronskian\ -\/\ 2.i.omega|oo\ is\ smaller\ than\ precision,\ false\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00926}00926\ \textcolor{comment}{//\ test\ :\ test\ of\ convergence\ of\ the\ asymptotic\ series.\ It\ is\ max(|a[n]|oo,|n.a[n]/z|oo).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00927}00927\ \textcolor{comment}{//\ sign\ :\ if\ i=0,\ it\ is\ omega,\ if\ i=1,\ it\ is\ -\/omega.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00928}00928\ \textcolor{comment}{//\ Ieta,two\_I\_eta\_sign\ :\ i.eta,\ 2.i.eta\ if\ sign\ =\ 1,\ -\/2.i.eta\ if\ sign\ =\ -\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00929}00929\ \textcolor{comment}{//\ Ieta\_Ieta\_plus\_sign\_minus\_ll\_plus\_one\ :\ i.eta(i.eta+1)\ -\/\ l(l+1)\ if\ sign=1,\ i.eta(i.eta-\/1)\ -\/\ l(l+1)\ if\ sign=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00930}00930\ \textcolor{comment}{//\ n,an\_sign\ :\ index\ of\ the\ series,\ a[n+1]}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00931}00931\ \textcolor{comment}{//\ n\_plus\_one,sign\_one\_over\_two\_I\_n\_plus\_one\ :\ n+1,\ 1/(2.i.(n+1))\ if\ sign=1,\ -\/1/(2.i.(n+1))\ if\ sign=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00932}00932\ \textcolor{comment}{//\ sum\_term,\ dsum\_term\ :\ an\_sign,\ (n+1).an\_sign/z}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00933}00933\ \textcolor{comment}{//\ two\_I\_omega\ :\ 2.i.omega\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00934}00934\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00935}00935\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::asymptotic\_series\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&one\_over\_z,}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00936}00936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::complex<double>\ sum[],std::complex<double>\ dsum[],\textcolor{keywordtype}{bool}\ \&is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00937}00937\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00938}00938\ \ \ sum[0]\ =\ sum[1]\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00939}00939\ \ \ dsum[0]\ =\ dsum[1]\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00940}00940\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00941}00941\ \ \ \textcolor{keywordtype}{double}\ test;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00942}00942\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00943}00943\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0\ ;\ i\ <=\ 1\ ;\ i++)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00944}00944\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00945}00945\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ sign\ =\ (i\ ==\ 0)\ ?\ (omega)\ :\ (-\/omega);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00946}00946\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ Ieta(-\/imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}})),two\_I\_eta\_sign\ =\ 2.0*sign*Ieta,Ieta\_Ieta\_plus\_sign\_minus\_ll\_plus\_one\ =\ Ieta*(Ieta\ +\ sign)\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}*(\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}+1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00947}00947\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00948}00948\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00949}00949\ \ \ \ \ std::complex<double>\ an\_sign\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00950}00950\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00951}00951\ \ \ \ \ \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00952}00952\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00953}00953\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ n\_plus\_one\ =\ n\ +\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00954}00954\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sign\_one\_over\_two\_I\_n\_plus\_one(0,-\/sign*0.5/n\_plus\_one);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00955}00955\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00956}00956\ \ \ \ \ \ \ an\_sign\ *=\ one\_over\_z*(n*(n\_plus\_one\ +\ two\_I\_eta\_sign)\ +\ Ieta\_Ieta\_plus\_sign\_minus\_ll\_plus\_one)*sign\_one\_over\_two\_I\_n\_plus\_one;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00957}00957\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00958}00958\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ sum\_term\ =\ an\_sign,dsum\_term\ =\ n\_plus\_one*an\_sign*one\_over\_z;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00959}00959\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00960}00960\ \ \ \ \ \ \ sum[i]\ +=\ sum\_term;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00961}00961\ \ \ \ \ \ \ dsum[i]\ -\/=\ dsum\_term;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00962}00962\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00963}00963\ \ \ \ \ \ \ test\ =\ std::max\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (sum\_term),\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (dsum\_term));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00964}00964\ \ \ \ \ \ \ n++;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00965}00965\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00966}00966\ \ \ \ \ \textcolor{keywordflow}{while}\ ((test\ >\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}})\ \&\&\ (\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (test)));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00967}00967\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00968}00968\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (test))\ \{is\_it\_successful\ =\ \textcolor{keyword}{false};\ \textcolor{keywordflow}{return};\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00969}00969\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00970}00970\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00971}00971\ \ \ \textcolor{keyword}{const}\ std::complex<double>\ two\_I\_omega(0.0,2.0*omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00972}00972\ \ \ is\_it\_successful\ =\ (\mbox{\hyperlink{complex__functions_8_h_ad94a1be6cb74ee6d43c816d7723f17c9}{inf\_norm}}\ (sum[1]*dsum[0]\ -\/\ sum[0]*dsum[1]\ +\ two\_I\_omega*(1.0\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*one\_over\_z)*sum[0]*sum[1]\ -\/\ two\_I\_omega)\ <\ \mbox{\hyperlink{complex__functions_8_h_a4f214e901f7e6a79fe34cb2cdc0b071e}{precision}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00973}00973\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00974}00974\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00975}00975\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00976}00976\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00977}00977\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00978}00978\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00979}00979\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00980}00980\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00981}00981\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00982}00982\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00983}00983\ \textcolor{comment}{//\ Numerical\ partial\ derivatives\ according\ to\ l\ or\ eta.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00984}00984\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00985}00985\ \textcolor{comment}{//\ One\ calculates\ here\ the\ partial\ derivatives\ according\ to\ l\ or\ eta}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00986}00986\ \textcolor{comment}{//\ of\ the\ Coulomb\ wave\ functions\ F(x)\ or\ G(x)\ and\ of\ their\ derivatives\ with\ x\ F'(x)\ or\ G'(x),}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00987}00987\ \textcolor{comment}{//\ with\ l\_r=Re[l]\ and\ eta\_r=Re[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00988}00988\ \textcolor{comment}{//\ One\ considers\ here\ the\ parameters\ l\_r\ and\ eta\_r\ with\ the\ argument\ x.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00989}00989\ \textcolor{comment}{//\ For\ this,\ one\ uses\ the\ standard\ formula\ :\ df/d\_chi(x)\ =\ [f(x,chi+eps)\ -\/\ f(x,chi-\/eps)]/[2.eps],\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00990}00990\ \textcolor{comment}{//\ with\ chi\ =\ l\_r\ or\ eta\_r\ and\ eps\ =\ prec\_first\_order\_expansion*chi.\ f\ is\ either\ F,\ F',\ G\ or\ G'.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00991}00991\ \textcolor{comment}{//\ One\ then\ calculates\ F\ or\ G,\ F'\ or\ G'\ with\ chi+eps\ and\ chi-\/eps.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00992}00992\ \textcolor{comment}{//\ With\ them,\ one\ obtains\ dF/d\_chi(x),dF'/d\_chi(x)\ or\ dG/d\_chi(x),dG'/d\_chi(x),\ with\ chi\ =\ l\ or\ eta.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00993}00993\ \textcolor{comment}{//\ All\ functions\ are\ real,\ so\ double\ values\ are\ returned,\ taking\ the\ real\ part\ of\ std::complex\ variables.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00994}00994\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00995}00995\ \textcolor{comment}{//\ Variables}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00996}00996\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00997}00997\ \textcolor{comment}{//\ is\_it\_regular\ :\ true\ if\ one\ calculates\ derivatives\ of\ F(z),F'(z),\ false\ if\ one\ calculates\ derivatives\ of\ G(z),G'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00998}00998\ \textcolor{comment}{//\ is\_it\_eta\ :\ true\ if\ one\ calculates\ the\ partial\ derivatives\ according\ to\ eta,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l00999}00999\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ false\ if\ one\ calculates\ the\ partial\ derivatives\ according\ to\ l.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01000}01000\ \textcolor{comment}{//\ cwf\_plus,cwf\_minus\ :\ references\ on\ class\ Coulomb\_wave\_functions\ with\ parameters\ l+eps,eta\ and\ l-\/eps,eta\ or\ l,eta+eps\ and\ l,eta-\/eps.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01001}01001\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ one\ calculates\ the\ partial\ derivatives\ according\ to\ eta,\ they\ are\ *cwf\_real\_eta\_plus\_ptr\ and\ *cwf\_real\_eta\_minus\_ptr.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01002}01002\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ If\ one\ calculates\ the\ partial\ derivatives\ according\ to\ l,\ they\ are\ *cwf\_real\_l\_plus\_ptr\ and\ *cwf\_real\_l\_minus\_ptr.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01003}01003\ \textcolor{comment}{//\ x\ :\ Re[z],\ z\ the\ argument\ of\ the\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01004}01004\ \textcolor{comment}{//\ d\_chi\_Bx,d\_chi\_dBx\ :\ partial\ derivatives\ of\ F\ and\ F'\ in\ l\_r,eta\_r,x\ according\ to\ chi\ =\ l\ or\ eta\ if\ is\_it\_regular\ is\ true,\ or\ G\ and\ G'\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01005}01005\ \textcolor{comment}{//\ l\_r,eta\_r,chi\_r\ :\ Re[l],Re[eta],\ Re[eta]\ is\ is\_it\_eta\ is\ true,\ Re[l]\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01006}01006\ \textcolor{comment}{//\ chi\_r\_plus,chi\_r\_minus\ :\ chi\_r+eps,\ chi\_r-\/eps.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01007}01007\ \textcolor{comment}{//\ A\_plus,dA\_plus,A\_minus,dA\_minus\ :\ F(x,chi+eps),F'(x,chi+eps),F(x,chi-\/eps),F'(x,chi-\/eps)\ if\ is\_it\_regular\ is\ true,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01008}01008\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ H+(x,chi+eps),H+'(x,chi+eps),H+(x,chi-\/eps),H+'(x,chi-\/eps)\ if\ is\_it\_regular\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01009}01009\ \textcolor{comment}{//\ B\_plus,B\_minus,dB\_plus,dB\_minus\ :\ F(x,chi+eps),F'(x,chi+eps),F(x,chi-\/eps),F'(x,chi-\/eps)\ if\ is\_it\_regular\ is\ true,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01010}01010\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G(x,chi+eps),G'(x,chi+eps),G(x,chi-\/eps),G'(x,chi-\/eps)\ if\ is\_it\_regular\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01011}01011\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01012}01012\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::partial\_derivatives\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_it\_regular,\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_it\_eta,\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x,\textcolor{keywordtype}{double}\ \&d\_chi\_Bx,\textcolor{keywordtype}{double}\ \&d\_chi\_dBx)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01013}01013\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01014}01014\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),chi\_r\ =\ (is\_it\_eta)\ ?\ (eta\_r)\ :\ (l\_r);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01015}01015\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ chi\_r\_plus\ =\ (chi\_r\ !=\ 0.0)\ ?\ (chi\_r*(1.0\ +\ prec\_first\_order\_expansion))\ :\ (prec\_first\_order\_expansion);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01016}01016\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ chi\_r\_minus\ =\ (chi\_r\ !=\ 0.0)\ ?\ (chi\_r*(1.0\ -\/\ prec\_first\_order\_expansion))\ :\ (-\/prec\_first\_order\_expansion);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01017}01017\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01018}01018\ \ \ \textcolor{keywordflow}{if}\ (is\_it\_eta)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01019}01019\ \ \ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01020}01020\ \ \ \ \ \textcolor{keywordflow}{if}\ (cwf\_real\_eta\_plus\_ptr\ ==\ 0)\ cwf\_real\_eta\_plus\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},l\_r,chi\_r\_plus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01021}01021\ \ \ \ \ \textcolor{keywordflow}{if}\ (cwf\_real\_eta\_minus\_ptr\ ==\ 0)\ cwf\_real\_eta\_minus\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},l\_r,chi\_r\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01022}01022\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01023}01023\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01024}01024\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01025}01025\ \ \ \ \ \textcolor{keywordflow}{if}\ (cwf\_real\_l\_plus\_ptr\ ==\ 0)\ cwf\_real\_l\_plus\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},chi\_r\_plus,eta\_r);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01026}01026\ \ \ \ \ \textcolor{keywordflow}{if}\ (cwf\_real\_l\_minus\_ptr\ ==\ 0)\ cwf\_real\_l\_minus\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},chi\_r\_minus,eta\_r);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01027}01027\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01028}01028\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01029}01029\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ \&cwf\_plus\ =\ (is\_it\_eta)\ ?\ (*cwf\_real\_eta\_plus\_ptr)\ :\ (*cwf\_real\_l\_plus\_ptr);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01030}01030\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ \&cwf\_minus\ =\ (is\_it\_eta)\ ?\ (*cwf\_real\_eta\_minus\_ptr)\ :\ (*cwf\_real\_l\_minus\_ptr);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01031}01031\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01032}01032\ \ \ std::complex<double>\ A\_plus,dA\_plus,A\_minus,dA\_minus;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01033}01033\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01034}01034\ \ \ \textcolor{keywordflow}{if}\ (is\_it\_regular)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01035}01035\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01036}01036\ \ \ \ \ cwf\_plus.\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (x,A\_plus,dA\_plus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01037}01037\ \ \ \ \ cwf\_minus.\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (x,A\_minus,dA\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01038}01038\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01039}01039\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01040}01040\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01041}01041\ \ \ \ \ cwf\_plus.\mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (1,x,A\_plus,dA\_plus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01042}01042\ \ \ \ \ cwf\_minus.\mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (1,x,A\_minus,dA\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01043}01043\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01044}01044\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01045}01045\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ B\_plus\ =\ real\ (A\_plus),B\_minus\ =\ real\ (A\_minus),dB\_plus\ =\ real\ (dA\_plus),dB\_minus\ =\ real\ (dA\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01046}01046\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01047}01047\ \ \ d\_chi\_Bx\ =\ (B\_plus\ -\/\ B\_minus)/(chi\_r\_plus\ -\/\ chi\_r\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01048}01048\ \ \ d\_chi\_dBx\ =\ (dB\_plus\ -\/\ dB\_minus)/(chi\_r\_plus\ -\/\ chi\_r\_minus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01049}01049\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01050}01050\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01051}01051\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01052}01052\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01053}01053\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01054}01054\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01055}01055\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01056}01056\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01057}01057\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01058}01058\ \textcolor{comment}{//\ Calculation\ of\ F(z),F'(z)\ or\ G(z),G'(z)\ with\ the\ first\ order\ expansion\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01059}01059\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01060}01060\ \textcolor{comment}{//\ When\ imaginary\ parts\ of\ l,eta,z\ are\ much\ smaller\ than\ their\ real\ parts\ but\ not\ all\ zero,\ with\ Re[z]\ >\ 0,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01061}01061\ \textcolor{comment}{//\ one\ has\ to\ separate\ the\ calculation\ of\ the\ real\ and\ imaginary\ parts\ of\ (F,G)(z)\ and\ (F',G')(z),\ as\ they\ can\ differ\ by\ tens\ of\ orders\ of\ magnitude.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01062}01062\ \textcolor{comment}{//\ Re[z]\ <\ 0\ is\ not\ considered,\ as\ G(z)\ is\ std::complex\ with\ Im[z]\ =\ Im[l]\ =\ Im[eta]\ =\ 0.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01063}01063\ \textcolor{comment}{//\ So,\ with\ z\ =\ x+i.y,\ eta\ =\ eta\_r\ +\ i.eta\_i\ and\ l\ =\ l\_r+i.l\_i,\ one\ calculates\ (F,G)[l\_r,eta\_r](x)\ and\ (F,G)'[l\_r,eta\_r](x).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01064}01064\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01065}01065\ \textcolor{comment}{//\ One\ considers\ here\ the\ parameters\ l\_r\ and\ eta\_r\ with\ the\ argument\ x,\ and\ the\ parameters\ l\ and\ eta\ with\ the\ argument\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01066}01066\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01067}01067\ \textcolor{comment}{//\ One\ then\ has\ F(x),F'(x)\ from\ usual\ relations\ and\ one\ takes\ their\ real\ parts.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01068}01068\ \textcolor{comment}{//\ One\ also\ has\ H+(x),H+'(x)\ from\ usual\ relations\ and\ G(x)\ =\ Re[H+(x)],G'(x)\ =\ Re[H+'(x)].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01069}01069\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01070}01070\ \textcolor{comment}{//\ After\ that,\ one\ expands\ (F,G)(z)\ and\ (F',G')(z)\ in\ first\ order\ in\ y,\ eta\_i\ and\ l\_i\ and\ one\ has,\ up\ to\ y\string^2,eta\_i\string^2\ and\ l\_i\string^2:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01071}01071\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01072}01072\ \textcolor{comment}{//\ (F,G)(z)\ =\ (F,G)(x)\ +\ i.y.d(F,G)/dx[omega](x)\ +\ i.eta\_i.d(F,G)/d[eta](x)\ +\ i.l\_i.d(F,G)/dl(x).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01073}01073\ \textcolor{comment}{//\ (F',G')[omega](z)\ =\ (F',G')[omega](x)\ +\ i.y.(F'',G'')[omega](x)\ +\ i.eta\_i.d(F',G')/d[eta](x)\ +\ i.l\_i.d(F',G')/dl(x).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01074}01074\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01075}01075\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01076}01076\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01077}01077\ \textcolor{comment}{//\ is\_it\_regular\ :\ true\ if\ one\ calculates\ F(z),F'(z),\ false\ if\ one\ calculates\ G(z),G'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01078}01078\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01079}01079\ \textcolor{comment}{//\ B,dB\ :\ F(z),F'(z)\ if\ is\_it\_regular\ is\ true,\ G(z),G'(z)\ if\ it\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01080}01080\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01081}01081\ \textcolor{comment}{//\ A\_x,dA\_x\ :\ F(x),F'(x)\ if\ is\_it\_regular\ is\ true,\ H+(x),H+'(x)\ if\ it\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01082}01082\ \textcolor{comment}{//\ Bx,dBx\ :\ F(x),F'(x)\ if\ is\_it\_regular\ is\ true,\ G(x),G'(x)\ if\ it\ is\ false.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01083}01083\ \textcolor{comment}{//\ cwf\_real\ :\ class\ Coulomb\_wave\_functions\ of\ parameters\ l\_r\ and\ eta\_r.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01084}01084\ \textcolor{comment}{//\ one\_over\_x,two\_eta\_r\ :\ 1/x,\ 2.eta\_r.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01085}01085\ \textcolor{comment}{//\ d\_l\_Bx,d\_l\_dBx,d\_eta\_Bx,d\_eta\_dBx\ :\ partial\ derivatives\ according\ to\ l\ and\ eta\ of\ B(x)\ and\ B'(x)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01086}01086\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ They\ are\ initialized\ at\ zero,\ and\ not\ calculated\ if\ they\ are\ multiplied\ by\ zero\ after.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01087}01087\ \textcolor{comment}{//\ Coulomb\_eq\_x,d2Bx\ :\ l\_r(l\_r+1)/[x\string^2]\ +\ 2.eta\_r/x\ -\/\ 1,\ B''(x)\ =\ [l\_r(l\_r+1)/[x\string^2]\ +\ 2.eta\_r/x\ -\/\ 1].B(x),}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01088}01088\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01089}01089\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01090}01090\ \textcolor{keywordtype}{void}\ Coulomb\_wave\_functions::first\_order\_expansions\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_it\_regular,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&B,std::complex<double>\ \&dB)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01091}01091\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01092}01092\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01093}01093\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01094}01094\ \ \ \textcolor{keywordflow}{if}\ (cwf\_real\_ptr\ ==\ 0)\ cwf\_real\_ptr\ =\ \textcolor{keyword}{new}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}},l\_r,eta\_r);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01095}01095\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_coulomb__wave__functions}{Coulomb\_wave\_functions}}\ \&cwf\_real\ =\ *cwf\_real\_ptr;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01096}01096\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01097}01097\ \ \ std::complex<double>\ A\_x,dA\_x;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01098}01098\ \ \ \textcolor{keywordflow}{if}\ (is\_it\_regular)\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01099}01099\ \ \ \ \ cwf\_real.\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (x,A\_x,dA\_x);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01100}01100\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01101}01101\ \ \ \ \ cwf\_real.\mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (1,x,A\_x,dA\_x);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01102}01102\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01103}01103\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ Bx\ =\ real\ (A\_x),dBx\ =\ real\ (dA\_x);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01104}01104\ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01105}01105\ \ \ \textcolor{keywordtype}{double}\ d\_l\_Bx\ =\ 0.0,d\_l\_dBx\ =\ 0.0,d\_eta\_Bx\ =\ 0.0,d\_eta\_dBx\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01106}01106\ \ \ \textcolor{keywordflow}{if}\ (l\_i\ !=\ 0.0)\ partial\_derivatives\ (is\_it\_regular,\textcolor{keyword}{false},x,d\_l\_Bx,d\_l\_dBx);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01107}01107\ \ \ \textcolor{keywordflow}{if}\ (eta\_i\ !=\ 0.0)\ partial\_derivatives\ (is\_it\_regular,\textcolor{keyword}{true},x,d\_eta\_Bx,d\_eta\_dBx);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01108}01108\ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01109}01109\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ one\_over\_x\ =\ 1.0/x,Coulomb\_eq\_x\ =\ (l\_r*(l\_r+1)*one\_over\_x\ +\ 2.0*eta\_r)*one\_over\_x\ -\/\ 1.0;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01110}01110\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ d2Bx\ =\ Coulomb\_eq\_x*Bx;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01111}01111\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01112}01112\ \ \ B\ =\ std::complex<double>\ (Bx,y*dBx\ +\ l\_i*d\_l\_Bx\ +\ eta\_i*d\_eta\_Bx);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01113}01113\ \ \ dB\ =\ std::complex<double>\ (dBx,y*d2Bx\ +\ l\_i*d\_l\_dBx\ +\ eta\_i*d\_eta\_dBx);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01114}01114\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01115}01115\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01116}01116\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01117}01117\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01118}01118\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01119}01119\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01120}01120\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01121}01121\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01122}01122\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01123}01123\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01124}01124\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01125}01125\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01126}01126\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01127}01127\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01128}01128\ \textcolor{comment}{//\ Regular\ wave\ function\ and\ derivative.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01129}01129\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01130}01130\ \textcolor{comment}{//\ One\ calculates\ F(z)\ and\ F'(z),\ so\ F(z)\ \string~\ z\string^\{l+1\}\ for\ z\ -\/>\ 0\ if\ is\_it\_normalized\ is\ false,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01131}01131\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ F(z)\ \string~\ C(l,eta).z\string^\{l+1\}\ for\ z\ -\/>\ 0\ if\ is\_it\_normalized\ is\ true.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01132}01132\ \textcolor{comment}{//\ If\ |z|\ <=\ 0.5,\ one\ uses\ the\ power\ series.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01133}01133\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01134}01134\ \textcolor{comment}{//\ If\ |z|\ >\ 0.5\ and\ Re[z]\ <\ 0,\ one\ calculates\ F(z)\ from\ F[l,-\/eta,-\/z]\ with\ F\_dF\_with\_symmetry\_relations.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01135}01135\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01136}01136\ \textcolor{comment}{//\ If\ |z|\ >\ 0.5\ and\ Re[z]\ >=\ 0,\ and\ 1+l+/-\/i.eta\ no\ negative\ integer,\ one\ first\ tries\ the\ asymptotic\ series\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01137}01137\ \textcolor{comment}{//\ If\ it\ failed,\ one\ integrates\ directly\ the\ regular\ Coulomb\ wave\ function\ with\ F\_dF\_direct\_integration.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01138}01138\ \textcolor{comment}{//\ If\ 1+l+/-\/i.eta\ is\ a\ negative\ integer,\ this\ is\ the\ only\ available\ method\ besides\ power\ series\ so\ it\ is\ accepted.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01139}01139\ \textcolor{comment}{//\ If\ 1+l+/-\/i.eta\ is\ no\ negative\ integer\ but\ it\ failed\ again,\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01140}01140\ \textcolor{comment}{//\ one\ calculates\ the\ Coulomb\ wave\ function\ H[omega]\ with\ H\_dH\_direct\_integration\ and\ omega\ =\ sign(Im[z]).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01141}01141\ \textcolor{comment}{//\ omega\ is\ chosen\ so\ one\ cannot\ encounter\ the\ branch\ cut\ of\ h[omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01142}01142\ \textcolor{comment}{//\ H[-\/omega]\ is\ calculated\ from\ H[omega]\ and\ continued\ fractions\ h[omega]\ and\ h[-\/omega].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01143}01143\ \textcolor{comment}{//\ One\ then\ has\ F(z)\ =\ (H[omega]\ -\/\ H[-\/omega])/(2.i.omega.norm),\ F'(z)\ =\ (H'[omega]\ -\/\ H'[-\/omega])/(2.i.omega.norm),}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01144}01144\ \textcolor{comment}{//\ with\ norm\ =\ 1\ if\ the\ wave\ functions\ are\ normalized\ and\ C(l,eta)\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01145}01145\ \textcolor{comment}{//\ The\ formula\ is\ stable\ as\ one\ uses\ this\ case\ only\ when\ |F(z)|\ >\ 0.1\ .}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01146}01146\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01147}01147\ \textcolor{comment}{//\ One\ takes\ only\ real\ parts\ if\ l,\ eta\ and\ z\ are\ real.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01148}01148\ \textcolor{comment}{//\ At\ the\ end\ of\ the\ function,\ one\ puts\ \{debut,F\_debut,dF\_debut\}\ equal\ to\ \{z,F,dF\}.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01149}01149\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01150}01150\ \textcolor{comment}{//\ Variables:}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01151}01151\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01152}01152\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01153}01153\ \textcolor{comment}{//\ F,dF\ :\ regular\ Coulomb\ wave\ function\ in\ z\ and\ derivative\ in\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01154}01154\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01155}01155\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ asymptotic\ expansions\ converges,\ false\ it\ not\ (after\ asymptotic\_expansion\_F\_dF).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01156}01156\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ true\ if\ the\ direct\ integration\ worked,\ false\ it\ not\ (after\ F\_dF\_direct\_integration).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01157}01157\ \textcolor{comment}{//\ omega\ :\ sign[Im[z]].\ H[omega](z)\ is\ calculated\ if\ the\ direct\ integration\ of\ F\ failed.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01158}01158\ \textcolor{comment}{//\ two\_I\_omega,\ two\_I\_term\ :\ 2.i.omega,\ 2.i.omega\ if\ is\_it\_normalized\ is\ true,\ 2.i.omega.Cl\_eta\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01159}01159\ \textcolor{comment}{//\ h\_omega,\ h\_minus\_omega\ :\ log\ derivatives\ of\ H[omega](z)\ and\ H[-\/omega](z)\ calculated\ with\ continued\ fractions.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01160}01160\ \textcolor{comment}{//\ H\_omega,dH\_omega,H\_minus\_omega,dH\_minus\_omega\ :\ H[omega](z),\ H[-\/omega](z)\ and\ derivatives}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01161}01161\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01162}\mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{01162}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{Coulomb\_wave\_functions::F\_dF}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&F,std::complex<double>\ \&dF)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01163}01163\ \{\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01164}01164\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01165}01165\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01166}01166\ \ \ \textcolor{keywordflow}{if}\ (((y\ !=\ 0.0)\ ||\ (eta\_i\ !=\ 0.0)\ ||\ (l\_i\ !=\ 0.0))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01167}01167\ \ \ \ \ \ \ \&\&\ (std::abs\ (y)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}}*std::min\ (1.0,x))\ \&\&\ (std::abs\ (eta\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})\ \&\&\ (std::abs\ (l\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01168}01168\ \ \ \ \ \ \ \&\&\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01169}01169\ \ \ \ \ first\_order\_expansions\ (\textcolor{keyword}{true},z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01170}01170\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (abs\ (z)\ <=\ 0.5)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01171}01171\ \ \ \ \ F\_dF\_power\_series\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01172}01172\ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01173}01173\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01174}01174\ \ \ \ \ \textcolor{keywordflow}{if}\ (real\ (z)\ <\ 0.0)\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01175}01175\ \ \ \ \ \ \ F\_dF\_with\_symmetry\_relations\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01176}01176\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01177}01177\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01178}01178\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_it\_successful\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01179}01179\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one)\ asymptotic\_expansion\_F\_dF\ (z,F,dF,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01180}01180\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01181}01181\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01182}01182\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01183}01183\ \ \ \ \ F\_dF\_direct\_integration\ (z,F,dF,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01184}01184\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01185}01185\ \ \ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one\ \&\&\ !is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01186}01186\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01187}01187\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega\ =\ \mbox{\hyperlink{complex__functions_8_h_a8c4a9e5e4622948245de4ec0b5d38329}{SIGN}}(imag\ (z));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01188}01188\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ two\_I\_omega(0.0,2.0*omega),two\_I\_term\ =\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (two\_I\_omega)\ :\ (two\_I\_omega*Cl\_eta*Cl\_eta);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01189}01189\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ h\_omega\ =\ continued\_fraction\_h\ (z,omega),h\_minus\_omega\ =\ continued\_fraction\_h\ (z,-\/omega),one\_over\_two\_I\_term\ =\ 1.0/two\_I\_term;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01190}01190\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01191}01191\ \ \ \ \ \ \ std::complex<double>\ H\_omega,dH\_omega;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01192}01192\ \ \ \ \ \ \ H\_dH\_direct\_integration\ (omega,z,H\_omega,dH\_omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01193}01193\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01194}01194\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ H\_minus\_omega\ =\ two\_I\_term/((h\_omega\ -\/\ h\_minus\_omega)*H\_omega),dH\_minus\_omega\ =\ h\_minus\_omega*H\_minus\_omega;\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01195}01195\ \ \ \ \ \ \ F\ =\ (H\_omega\ -\/\ H\_minus\_omega)*one\_over\_two\_I\_term;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01196}01196\ \ \ \ \ \ \ dF\ =\ (dH\_omega\ -\/\ dH\_minus\_omega)*one\_over\_two\_I\_term;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01197}01197\ \ \ \ \ \}\}\}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01198}01198\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01199}01199\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01200}01200\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (F)\ ||\ !\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (dF))\ std::cout<<\textcolor{stringliteral}{"{}Numerical\ failure\ encountered\ in\ F\_dF."{}}<<std::endl,exit\ (1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01201}01201\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01202}01202\ \ \ \textcolor{keywordflow}{if}\ ((y\ ==\ 0.0)\ \&\&\ (eta\_i\ ==\ 0.0)\ \&\&\ (l\_i\ ==\ 0.0))\ F\ =\ real\ (F),dF\ =\ real\ (dF);\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01203}01203\ \ \ debut\ =\ z,F\_debut\ =\ F,dF\_debut\ =\ dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01204}01204\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01205}01205\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01206}01206\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01207}01207\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01208}01208\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01209}01209\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01210}01210\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01211}01211\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01212}01212\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01213}01213\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01214}01214\ \textcolor{comment}{//\ Calculation\ of\ G(z)\ and\ G'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01215}01215\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01216}01216\ \textcolor{comment}{//\ One\ calculates\ the\ irregular\ Coulomb\ wave\ function\ from\ H+\ and\ F.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01217}01217\ \textcolor{comment}{//\ If\ 1+l+i.omega.eta\ is\ a\ negative\ integer,\ G\ is\ by\ definition\ H[-\/omega].\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01218}01218\ \textcolor{comment}{//\ If\ not,\ one\ uses\ the\ formulas\ :\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01219}01219\ \textcolor{comment}{//\ G(z)\ =\ H+(z)\ -\/\ i.F(z),\ G'(z)\ =\ H+'(z)\ -\/\ i.F'(z)\ if\ is\_it\_normalized\ is\ true,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01220}01220\ \textcolor{comment}{//\ G(z)\ =\ H+(z)\ -\/\ i.Cl\_eta\string^2.F(z),\ G'(z)\ =\ H+'(z)\ -\/\ i.Cl\_eta\string^2.F'(z)\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01221}01221\ \textcolor{comment}{//\ There\ is\ no\ numerical\ inaccuracy\ as\ G\ is\ never\ a\ minimal\ solution.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01222}01222\ \textcolor{comment}{//\ One\ takes\ only\ real\ parts\ if\ l,\ eta\ and\ z\ are\ real.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01223}01223\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01224}01224\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01225}01225\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01226}01226\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01227}01227\ \textcolor{comment}{//\ G,dG\ :\ irregular\ Coulomb\ wave\ functions\ and\ derivatives.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01228}01228\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01229}01229\ \textcolor{comment}{//\ H\_plus,dH\_plus\ :\ H+(z)\ and\ H+'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01230}01230\ \textcolor{comment}{//\ F,dF\ :\ regular\ Coulomb\ wave\ functions\ and\ derivatives.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01231}01231\ \textcolor{comment}{//\ I\_Cl\_eta\_square\ :\ i.C(l,eta)\string^2.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01232}01232\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01233}\mbox{\hyperlink{class_coulomb__wave__functions_a290186f37ddca40667af2a0acb031fcb}{01233}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_coulomb__wave__functions_a290186f37ddca40667af2a0acb031fcb}{Coulomb\_wave\_functions::G\_dG}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&G,std::complex<double>\ \&dG)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01234}01234\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01235}01235\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01236}01236\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01237}01237\ \ \ \textcolor{keywordflow}{if}\ (((y\ !=\ 0.0)\ ||\ (eta\_i\ !=\ 0.0)\ ||\ (l\_i\ !=\ 0.0))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01238}01238\ \ \ \ \ \ \ \&\&\ (std::abs\ (y)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}}*std::min\ (1.0,x))\ \&\&\ (std::abs\ (eta\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})\ \&\&\ (std::abs\ (l\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01239}01239\ \ \ \ \ \ \ \&\&\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01240}01240\ \ \ \ \ first\_order\_expansions\ (\textcolor{keyword}{false},z,G,dG);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01241}01241\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01242}01242\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01243}01243\ \ \ \ \ \textcolor{keywordflow}{if}\ (neg\_int\_omega\_one)\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01244}01244\ \ \ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (-\/1,z,G,dG);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01245}01245\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (neg\_int\_omega\_minus\_one)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01246}01246\ \ \ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (1,z,G,dG);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01247}01247\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01248}01248\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01249}01249\ \ \ \ \ \ \ std::complex<double>\ F,dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01250}01250\ \ \ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01251}01251\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01252}01252\ \ \ \ \ \ \ std::complex<double>\ H\_plus,dH\_plus;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01253}01253\ \ \ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{H\_dH}}\ (1,z,H\_plus,dH\_plus);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01254}01254\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01255}01255\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I(0.0,1.0);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01256}01256\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01257}01257\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01258}01258\ \ \ \ \ G\ =\ H\_plus\ -\/\ I*F,dG\ =\ dH\_plus\ -\/\ I*dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01259}01259\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01260}01260\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01261}01261\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_Cl\_eta\_square\ =\ I*Cl\_eta*Cl\_eta;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01262}01262\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01263}01263\ \ \ \ \ \textcolor{keywordflow}{if}\ ((I\_Cl\_eta\_square\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (I\_Cl\_eta\_square)))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01264}01264\ \ \ \ \ \ \ G\ =\ H\_plus\ -\/\ I*exp\ (2.0*log\_Cl\_eta\ +\ log\ (F)),dG\ =\ dH\_plus\ -\/\ I*exp\ (2.0*log\_Cl\_eta\ +\ log\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01265}01265\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01266}01266\ \ \ \ \ \ \ G\ =\ H\_plus\ -\/\ I\_Cl\_eta\_square*F,dG\ =\ dH\_plus\ -\/\ I\_Cl\_eta\_square*dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01267}01267\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01268}01268\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01269}01269\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((y\ ==\ 0.0)\ \&\&\ (eta\_i\ ==\ 0.0)\ \&\&\ (l\_i\ ==\ 0.0))\ G\ =\ real\ (G),dG\ =\ real\ (dG);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01270}01270\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01271}01271\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01272}01272\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01273}01273\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01274}01274\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01275}01275\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01276}01276\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01277}01277\ \textcolor{comment}{//\ Calculation\ of\ H[omega](z)\ and\ H'[omega](z).\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01278}01278\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01279}01279\ \textcolor{comment}{//\ One\ first\ tries\ the\ asymptotic\ expansion\ formula\ if\ 1+l+/-\/i.eta\ is\ no\ negative\ integer.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01280}01280\ \textcolor{comment}{//\ On\ uses\ logs\ if\ the\ unscaling\ factor\ underflows\ or\ overflows.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01281}01281\ \textcolor{comment}{//\ If\ it\ failed,\ and\ imaginary\ parts\ of\ l,eta,z\ are\ much\ smaller\ than\ their\ real\ parts\ but\ not\ all\ zero,\ with\ Re[z]\ >\ 0,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01282}01282\ \textcolor{comment}{//\ one\ calculates\ H[omega](z)\ and\ H'[omega](z)\ with\ the\ first\ order\ expansion\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01283}01283\ \textcolor{comment}{//\ If\ one\ is\ not\ in\ this\ case,\ one\ calculates\ F(z)and\ F'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01284}01284\ \textcolor{comment}{//\ If\ |Im[l]|\ >\ 1\ and\ |z|\ <=\ 1,\ one\ tries\ the\ expansion\ formula\ with\ F(l,eta,z)\ and\ F(-\/l-\/1,eta,z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01285}01285\ \textcolor{comment}{//\ If\ not,\ or\ if\ it\ failed,\ one\ uses\ the\ continued\ fraction\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01286}01286\ \textcolor{comment}{//\ If\ l,eta\ and\ z\ are\ real,\ one\ rewrites\ H[omega]\ as\ H[omega]\ =\ Re[H[omega]]\ +\ i.omega.norm.Re[F]\ to\ avoid\ numerical\ inaccuracies\ for\ Im[H[omega]].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01287}01287\ \textcolor{comment}{//\ norm\ is\ 1\ if\ is\_it\_normalized\ is\ true,\ C(l,eta)\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01288}01288\ \textcolor{comment}{//\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01289}01289\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01290}01290\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01291}01291\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01292}01292\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z),\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01293}01293\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01294}01294\ \textcolor{comment}{//\ H,dH\ :\ H+(z)\ and\ H+'(z)\ if\ omega=1,\ H-\/(z)\ and\ H-\/'(z)\ if\ omega=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01295}01295\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ asymptotic\ expansions\ converges,\ false\ it\ not\ (in\ asymptotic\_expansion\_H\_dH\_scaled).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01296}01296\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ true\ if\ the\ expansion\ formula\ with\ F(l,eta,z)\ and\ F(-\/l-\/1,eta,z)\ worked,\ false\ it\ not\ (in\ H\_dH\_with\_expansion).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01297}01297\ \textcolor{comment}{//\ H\_scaled,dH\_scaled\ :\ H[omega](z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]])\ and\ H'[omega](z).exp[-\/i.omega.z.[z\ -\/\ eta.log[2z]])\ given\ by\ the\ asymptotic\ expansion\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01298}01298\ \textcolor{comment}{//\ I\_omega\_z,log\_unscale,unscale\ :\ i.omega,i.omega.[z\ -\/\ eta.log[2z]],exp[i.omega.[z\ -\/\ eta.log[2z]]]}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01299}01299\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01300}01300\ \textcolor{comment}{//\ F,dF\ :\ regular\ Coulomb\ wave\ function\ and\ derivative\ in\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01301}01301\ \textcolor{comment}{//\ omega\_norm\_functions\ :\ for\ l,eta,z\ real,\ omega.C(l,eta)\string^2\ if\ is\_it\_normalized\ is\ false,\ omega\ if\ it\ is\ true.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01302}01302\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ One\ indeed\ has\ H[omega]\ =\ G\ +\ I.omega.norm.F,\ with\ in\ this\ case\ G\ and\ omega.norm.F\ as\ its\ real\ and\ imaginary\ parts.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01303}01303\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01304}\mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{01304}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_coulomb__wave__functions_aed77d82a52638ff69f9526ad7504795f}{Coulomb\_wave\_functions::H\_dH}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H,std::complex<double>\ \&dH)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01305}01305\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01306}01306\ \ \ \textcolor{keywordtype}{bool}\ is\_it\_successful\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01307}01307\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01308}01308\ \ \ std::complex<double>\ H\_scaled,dH\_scaled;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01309}01309\ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one)\ asymptotic\_expansion\_H\_dH\_scaled\ (omega,1.0/z,H\_scaled,dH\_scaled,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01310}01310\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01311}01311\ \ \ \textcolor{keywordflow}{if}\ (is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01312}01312\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01313}01313\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0,omega),log\_unscale\ =\ I\_omega*(z\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*(M\_LN2\ +\ log\ (z))),unscale\ =\ exp\ (log\_unscale);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01314}01314\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01315}01315\ \ \ \ \ \textcolor{keywordflow}{if}\ ((unscale\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (unscale)))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01316}01316\ \ \ \ \ \ \ H\ =\ exp\ (log\ (H\_scaled)\ +\ log\_unscale),dH\ =\ exp\ (log\ (dH\_scaled)\ +\ log\_unscale);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01317}01317\ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01318}01318\ \ \ \ \ \ \ H\ =\ H\_scaled*unscale,dH\ =\ dH\_scaled*unscale;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01319}01319\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01320}01320\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01321}01321\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01322}01322\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01323}01323\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01324}01324\ \ \ \ \ \textcolor{keywordflow}{if}\ (((y\ !=\ 0.0)\ ||\ (eta\_i\ !=\ 0.0)\ ||\ (l\_i\ !=\ 0.0))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01325}01325\ \ \ \ \ \&\&\ (std::abs\ (y)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}}*std::min\ (1.0,x))\ \&\&\ (std::abs\ (eta\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})\ \&\&\ (std::abs\ (l\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01326}01326\ \ \ \ \ \&\&\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01327}01327\ \ \ \ \ \ \ H\_dH\_from\_first\_order\_expansions\ (omega,z,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01328}01328\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01329}01329\ \ \ \ \ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01332}01332\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one\ \&\&\ (std::abs\ (l\_i)\ >=\ 1.0)\ \&\&\ (std::abs\ (z)\ <=\ 1.0))\ H\_dH\_with\_expansion\ (omega,z,H,dH,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01333}01333\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01334}01334\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)\ H\_dH\_with\_F\_dF\_and\_CF\ (omega,z,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01335}01335\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01336}01336\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((y\ ==\ 0.0)\ \&\&\ (eta\_i\ ==\ 0.0)\ \&\&\ (l\_i\ ==\ 0.0))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01337}01337\ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01338}01338\ \ \ \ \ std::complex<double>\ F,dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01339}01339\ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01340}01340\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01341}01341\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ omega\_norm\_functions\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (omega*real\ (Cl\_eta)*real\ (Cl\_eta))\ :\ (omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01342}01342\ \ \ \ \ H\ =\ std::complex<double>\ (real\ (H),omega\_norm\_functions*real\ (F));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01343}01343\ \ \ \ \ dH\ =\ std::complex<double>\ (real\ (dH),omega\_norm\_functions*real\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01344}01344\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01345}01345\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01346}01346\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01347}01347\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01348}01348\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (H)\ ||\ !\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (dH))\ std::cout<<\textcolor{stringliteral}{"{}Numerical\ failure\ encountered\ in\ H\_dH."{}}<<std::endl,exit\ (1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01349}01349\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01350}01350\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01351}01351\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01352}01352\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01353}01353\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01354}01354\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01355}01355\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01356}01356\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01357}01357\ \textcolor{comment}{//\ Calculation\ of\ the\ scaled\ H[omega](z)\ and\ H'[omega](z).\ }}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01358}01358\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01359}01359\ \textcolor{comment}{//\ They\ are\ H(omega)(z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]]]\ and\ dH(omega)/dz(z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]]].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01360}01360\ \textcolor{comment}{//\ One\ first\ tries\ the\ asymptotic\ expansion\ formula\ if\ 1+l+/-\/i.eta\ is\ no\ negative\ integer.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01361}01361\ \textcolor{comment}{//\ If\ it\ failed,\ and\ imaginary\ parts\ of\ l,eta,z\ are\ much\ smaller\ than\ their\ real\ parts\ but\ not\ all\ zero,\ with\ Re[z]\ >\ 0,}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01362}01362\ \textcolor{comment}{//\ one\ calculates\ H[omega](z)\ and\ H'[omega](z)\ with\ the\ first\ order\ expansion\ method.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01363}01363\ \textcolor{comment}{//\ If\ one\ is\ not\ in\ this\ case,\ one\ calculates\ F(z)\ and\ F'(z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01364}01364\ \textcolor{comment}{//\ If\ |Im[l]|\ >\ 1\ and\ |z|\ <=\ 1,\ one\ tries\ the\ expansion\ formula\ with\ F(l,eta,z)\ and\ F(-\/l-\/1,eta,z).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01365}01365\ \textcolor{comment}{//\ If\ not,\ or\ if\ it\ failed,\ one\ uses\ the\ continued\ fraction\ formula.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01366}01366\ \textcolor{comment}{//\ If\ l,eta\ and\ z\ are\ real,\ one\ rewrites\ H[omega]\ as\ H[omega]\ =\ Re[H[omega]]\ +\ I.omega.norm.Re[F],\ to\ avoid\ numerical\ inaccuracies\ for\ Im[H[omega]].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01367}01367\ \textcolor{comment}{//\ norm\ is\ 1\ if\ is\_it\_normalized\ is\ true,\ C(l,eta)\string^2\ if\ not.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01368}01368\ \textcolor{comment}{//\ One\ uses\ logs\ if\ the\ scaling\ factor\ underflows\ or\ overflows.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01369}01369\ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01370}01370\ \textcolor{comment}{//\ Variables\ :}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01371}01371\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01372}01372\ \textcolor{comment}{//\ omega\ :\ 1\ if\ one\ calculates\ H+(z)\ and\ H+'(z)\ scaled,\ -\/1\ if\ one\ calculates\ H-\/(z)\ and\ H-\/'(z)\ scaled.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01373}01373\ \textcolor{comment}{//\ z\ :\ variable\ of\ the\ Coulomb\ wave\ function.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01374}01374\ \textcolor{comment}{//\ H\_scaled,dH\_scaled\ :\ H[omega](z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]])\ and\ H'[omega](z).exp[-\/i.omega.[z\ -\/\ eta.log[2z]]).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01375}01375\ \textcolor{comment}{//\ is\_it\_successful\ :\ true\ if\ the\ asymptotic\ expansions\ converges,\ false\ it\ not\ (in\ asymptotic\_expansion\_H\_dH\_scaled).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01376}01376\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ true\ if\ the\ expansion\ formula\ with\ F(l,eta,z)\ and\ F(-\/l-\/1,eta,z)\ worked,\ false\ it\ not\ (in\ H\_dH\_with\_expansion).}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01377}01377\ \textcolor{comment}{//\ x,y,l\_r,l\_i,eta\_r,eta\_i\ :\ Re[z],\ Im[z],\ Re[l],\ Im[l],\ Re[eta],\ Im[eta].}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01378}01378\ \textcolor{comment}{//\ F,dF\ :\ regular\ Coulomb\ wave\ function\ and\ derivative\ in\ z.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01379}01379\ \textcolor{comment}{//\ H,dH\ :\ H+(z)\ and\ H+'(z)\ if\ omega=1,\ H-\/(z)\ and\ H-\/'(z)\ if\ omega=-\/1.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01380}01380\ \textcolor{comment}{//\ omega\_norm\_functions\ :\ for\ l,eta,z\ real,\ omega.C(l,eta)\string^2\ if\ is\_it\_normalized\ is\ false,\ omega\ if\ it\ is\ true.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01381}01381\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ One\ indeed\ has\ H[omega]\ =\ G\ +\ I.omega.norm.F,\ with\ in\ this\ case\ G\ and\ omega.norm.F\ as\ its\ real\ and\ imaginary\ parts.}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01382}01382\ \textcolor{comment}{//\ I\_omega\_z,log\_scale,scale\ :\ i.omega,-\/i.omega.[z\ -\/\ eta.log[2z]],exp[-\/i.omega.[z\ -\/\ eta.log[2z]]]}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01383}01383\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01384}\mbox{\hyperlink{class_coulomb__wave__functions_a4820d8d44ee5c5e9193c8950e98935c2}{01384}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_coulomb__wave__functions_a4820d8d44ee5c5e9193c8950e98935c2}{Coulomb\_wave\_functions::H\_dH\_scaled}}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ omega,\textcolor{keyword}{const}\ std::complex<double>\ \&z,std::complex<double>\ \&H\_scaled,std::complex<double>\ \&dH\_scaled)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01385}01385\ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01386}01386\ \ \ \textcolor{keywordtype}{bool}\ is\_it\_successful\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01387}01387\ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one)\ asymptotic\_expansion\_H\_dH\_scaled\ (omega,1.0/z,H\_scaled,dH\_scaled,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01388}01388\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01389}01389\ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01390}01390\ \ \ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01391}01391\ \ \ \ \ std::complex<double>\ H,dH;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01392}01392\ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01393}01393\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ x\ =\ real\ (z),y\ =\ imag\ (z),l\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),l\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a184f08ca7adeb5d334b72dc354777a64}{l}}),eta\_r\ =\ real\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}),eta\_i\ =\ imag\ (\mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}});}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01394}01394\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01395}01395\ \ \ \ \ \textcolor{keywordflow}{if}\ (((y\ !=\ 0.0)\ ||\ (eta\_i\ !=\ 0.0)\ ||\ (l\_i\ !=\ 0.0))\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01396}01396\ \ \ \ \ \&\&\ (std::abs\ (y)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}}*std::min\ (1.0,x))\ \&\&\ (std::abs\ (eta\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})\ \&\&\ (std::abs\ (l\_i)\ <\ \mbox{\hyperlink{complex__functions_8_h_acee010e7dc0752836d30a2b57075f57b}{sqrt\_precision}})}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01397}01397\ \ \ \ \ \&\&\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01398}01398\ \ \ \ \ \ \ H\_dH\_from\_first\_order\_expansions\ (omega,z,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01399}01399\ \ \ \ \ \textcolor{keywordflow}{else}\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01400}01400\ \ \ \ \ \{\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01403}01403\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!neg\_int\_omega\_one\ \&\&\ !neg\_int\_omega\_minus\_one\ \&\&\ (std::abs\ (l\_i)\ >=\ 1.0)\ \&\&\ (abs\ (z)\ <=\ 1.0))\ H\_dH\_with\_expansion\ (omega,z,H,dH,is\_it\_successful);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01404}01404\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01405}01405\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_it\_successful)\ H\_dH\_with\_F\_dF\_and\_CF\ (omega,z,H,dH);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01406}01406\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01407}01407\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((y\ ==\ 0.0)\ \&\&\ (eta\_i\ ==\ 0.0)\ \&\&\ (l\_i\ ==\ 0.0))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01408}01408\ \ \ \ \ \ \ \{\ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01409}01409\ \ \ \ \ std::complex<double>\ F,dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01410}01410\ \ \ \ \ \mbox{\hyperlink{class_coulomb__wave__functions_aa50c907890ba95453087824914c3a90b}{F\_dF}}\ (z,F,dF);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01411}01411\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01412}01412\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ omega\_norm\_functions\ =\ (!\mbox{\hyperlink{class_coulomb__wave__functions_a11b791087220f0194b2750d36946392e}{is\_it\_normalized}})\ ?\ (omega*real\ (Cl\_eta)*real\ (Cl\_eta))\ :\ (omega);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01413}01413\ \ \ \ \ H\ =\ std::complex<double>\ (real\ (H),omega\_norm\_functions*real\ (F));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01414}01414\ \ \ \ \ dH\ =\ std::complex<double>\ (real\ (dH),omega\_norm\_functions*real\ (dF));}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01415}01415\ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01416}01416\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01417}01417\ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01418}01418\ \ \ \ \ \textcolor{keyword}{const}\ std::complex<double>\ I\_omega(0,omega),log\_scale\ =\ -\/I\_omega*(z\ -\/\ \mbox{\hyperlink{class_coulomb__wave__functions_a944d6723016c4c50ad7a9b55d62a0131}{eta}}*(M\_LN2\ +\ log\ (z))),scale\ =\ exp\ (log\_scale);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01419}01419\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01420}01420\ \ \ \ \ \textcolor{keywordflow}{if}\ ((scale\ ==\ 0.0)\ ||\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (scale)))}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01421}01421\ \ \ \ \ \ \ H\_scaled\ =\ exp\ (log\ (H)\ +\ log\_scale),dH\_scaled\ =\ exp\ (log\ (dH)\ +\ log\_scale);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01422}01422\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01423}01423\ \ \ \ \ \ \ H\_scaled\ =\ H*scale,dH\_scaled\ =\ dH*scale;\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01424}01424\ \ \ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01425}01425\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01426}01426\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (H\_scaled)\ ||\ !\mbox{\hyperlink{complex__functions_8_h_a620d539dcfcd19bcfaf73a750cb8fb17}{isfinite}}\ (dH\_scaled))\ std::cout<<\textcolor{stringliteral}{"{}Numerical\ failure\ encountered\ in\ H\_dH\_scaled."{}}<<std::endl,exit\ (1);}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01427}01427\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01428}01428\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01429}01429\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01430}01430\ \textcolor{comment}{//\ Storage\ of\ initial\ conditions\ debut,F(debut),F'(debut)}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01431}01431\ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01432}01432\ }
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01433}\mbox{\hyperlink{class_coulomb__wave__functions_a6b3367113a7be7ef3b23b15a24dccceb}{01433}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_coulomb__wave__functions_a6b3367113a7be7ef3b23b15a24dccceb}{Coulomb\_wave\_functions::F\_dF\_init}}\ (\textcolor{keyword}{const}\ std::complex<double>\ \&z,\textcolor{keyword}{const}\ std::complex<double>\ \&F,\textcolor{keyword}{const}\ std::complex<double>\ \&dF)}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01434}01434\ \{}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01435}01435\ \ \ debut\ =\ z,\ F\_debut\ =\ F,\ dF\_debut\ =\ dF;}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01436}01436\ \}}
\DoxyCodeLine{\Hypertarget{cwfcomp_8cpp_source_l01437}01437\ }

\end{DoxyCode}
